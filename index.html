<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<!-- åˆ†é ç”¨ -->
<link rel="icon" type="image/png" sizes="32x32" href="icon.png">
<!-- iOS ä¸»ç•«é¢ç”¨ -->
<link rel="apple-touch-icon" sizes="180x180" href="icon.png">
<!-- Android PWA -->
<link rel="manifest" href="manifest.json">
Â Â <meta charset="UTF-8">
Â Â <title>é¸æ“‡å°å¹«æ‰‹</title>
Â Â <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
Â Â <style>
Â Â Â Â body {
Â Â Â Â Â Â font-family: "Segoe UI", sans-serif;
Â Â Â Â Â Â background-color: #f0f9ff;
Â Â Â Â Â Â margin: 0;
Â Â Â Â Â Â padding: 0;
Â Â Â Â }
Â Â Â Â .footer-note {
Â Â position: fixed;
Â Â bottom: 10px;
Â Â right: 15px;
Â Â font-size: 0.9em;
Â Â color: #aaa;
Â Â font-style: italic;
Â Â pointer-events: none;
Â Â user-select: none;
}
Â Â Â Â .nav {
Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â justify-content: center;
Â Â Â Â Â Â background-color: #a8dadc;
Â Â Â Â Â Â padding: 10px 0;
Â Â Â Â Â Â flex-wrap: wrap;
Â Â Â Â }
Â Â Â Â .nav button {
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â padding: 10px 20px;
Â Â Â Â Â Â margin: 6px;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â background-color: #ffffff;
Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â box-shadow: 0 2px 6px rgba(0,0,0,0.15);
Â Â Â Â Â Â transition: all 0.2s ease;
Â Â Â Â }
Â Â Â Â .nav button.active {
Â Â Â Â Â Â background-color: #ffe066;
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â transform: scale(1.05);
Â Â Â Â }
Â Â Â Â .page {
Â Â Â Â Â Â display: none;
Â Â Â Â Â Â padding: 20px;
Â Â Â Â Â Â max-width: 600px;
Â Â Â Â Â Â margin: auto;
Â Â Â Â }
Â Â Â Â .page.active {
Â Â Â Â Â Â display: block;
Â Â Â Â }
Â Â Â Â h1 {
Â Â Â Â Â Â text-align: center;
Â Â Â Â Â Â padding: 20px;
Â Â Â Â Â Â color: #2c3e50;
Â Â Â Â Â Â margin: 0;
Â Â Â Â }
Â Â Â Â .btn-primary {
Â Â Â Â Â Â background-color: #3db8c4;
Â Â Â Â Â Â color: white;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â border-radius: 8px;
Â Â Â Â Â Â padding: 12px 20px;
Â Â Â Â Â Â font-size: 18px;
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â box-shadow: 0 4px 6px rgba(0,0,0,0.1);
Â Â Â Â Â Â transition: all 0.2s ease;
Â Â Â Â }
.btn-primary:hover {
Â Â background-color: #35a4af;
Â Â box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}
.btn-primary:active {
Â Â background-color: #2d8e98;
Â Â box-shadow: 0 2px 4px rgba(0,0,0,0.2) inset;
}
Â Â Â Â .btn-yellow {
Â Â Â Â Â Â background-color: #fff3b0;
Â Â Â Â Â Â color: #333;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â border-radius: 8px;
Â Â Â Â Â Â padding: 10px 14px;
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â margin: 4px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â }
Â Â Â Â input, select, button {
Â Â Â Â Â Â padding: 10px;
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â margin: 6px 4px 10px 0;
Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â border: 1px solid #ccc;
Â Â Â Â Â Â box-sizing: border-box;
Â Â Â Â }
Â Â Â Â input, select {
Â Â Â Â Â Â width: 100%;
Â Â Â Â }
ul#sortList {
Â Â max-width: 320px;
Â Â width: 90%;
Â Â margin: 0 auto;Â  Â  Â  Â  Â  /* ç½®ä¸­ */
Â Â padding: 0 8px;Â  Â  Â  Â  Â  /* é©åº¦å…§è· */
Â Â padding-right: 16px; /* å¢åŠ å³å´æ»‘å‹•ç·©è¡å€ */
}
li {
Â Â background: #f0fdf4; Â  Â  /* æ·¡ç¶ åº• */
Â Â padding: 6px 8px;
Â Â max-width: 200px;
width: 85%;
Â Â margin-bottom: 4px;
Â Â border-radius: 4px;
Â Â display: flex;
Â Â justify-content: space-between;
Â Â align-items: center;
}

Â Â Â Â li span {
Â Â Â Â Â Â flex-grow: 1;
Â Â Â Â Â Â min-width: 0;
Â Â Â Â Â Â white-space: nowrap;
Â Â Â Â Â Â overflow: hidden;
Â Â Â Â Â Â text-overflow: ellipsis;
Â Â Â Â }
Â Â Â Â .remove-btn {
Â Â Â Â Â Â background: none;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â color: #c0392b;
Â Â Â Â Â Â font-size: 18px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â margin-left: 10px;
Â Â Â Â Â Â flex-shrink: 0;
Â Â Â Â }
Â Â Â Â .random-container {
Â Â Â Â Â Â text-align: center;
Â Â Â Â Â Â margin-top: 20px;
Â Â Â Â }
Â Â Â Â .result-card {
Â Â Â Â Â Â margin-top: 30px;
Â Â Â Â Â Â padding: 30px;
Â Â Â Â Â Â background: linear-gradient(145deg, #fff8dc, #fff6ae);
Â Â Â Â Â Â border-radius: 20px;
Â Â Â Â Â Â box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
Â Â Â Â Â Â font-size: 2.2em;
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â color: #b34400;
Â Â Â Â Â Â opacity: 0;
Â Â Â Â Â Â transform: scale(0.5);
Â Â Â Â Â Â transition: all 0.6s ease;
Â Â Â Â Â Â Â Â white-space: nowrap; Â  Â  Â  Â  Â  Â  /* ä¸æ›è¡Œ */
Â Â overflow: hidden;Â  Â  Â  Â  Â  Â  Â  Â  /* è¶…å‡ºéš±è— */
Â Â text-overflow: ellipsis;Â  Â  Â  Â  /* åŠ ä¸Šçœç•¥è™Ÿï¼ˆå¯é¸ï¼‰ */
Â Â font-size: clamp(1.5em, 7vw, 3em); /* è‡ªå‹•ç¸®æ”¾æ–‡å­—å¤§å°ï¼Œé¿å…æ›è¡Œ */
Â Â Â Â }
Â Â Â Â .result-card.show {
Â Â Â Â Â Â opacity: 1;
Â Â Â Â Â Â transform: scale(1);
Â Â Â Â }
Â Â Â Â .result-card.glow {
Â Â Â Â Â Â animation: multiGlow 1.8s ease-out;
Â Â Â Â Â Â animation-fill-mode: both;
Â Â Â Â }
Â Â Â Â @keyframes fadeOutShrink {
Â Â 0% {
Â Â Â Â opacity: 1;
Â Â Â Â transform: scale(1);
Â Â }
Â Â 100% {
Â Â Â Â opacity: 0;
Â Â Â Â transform: scale(0.6);
Â Â }
}
.result-card.fade-out {
Â Â animation: fadeOutShrink 0.4s ease forwards;
}
Â Â Â Â @keyframes multiGlow {
Â Â Â Â Â Â 0% Â  { box-shadow: 0 0 0 transparent; }
Â Â Â Â Â Â 20%Â  { box-shadow: 0 0 20px #ffd700; }
Â Â Â Â Â Â 40%Â  { box-shadow: 0 0 25px #ffffff; }
Â Â Â Â Â Â 60%Â  { box-shadow: 0 0 30px #ff8c00; }
Â Â Â Â Â Â 80%Â  { box-shadow: 0 0 25px #ffe066; }
Â Â Â Â Â Â 100% { box-shadow: 0 0 20px #ffd700; }
Â Â Â Â }
Â Â Â Â .current-list-label {
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â margin-bottom: 10px;
Â Â Â Â Â Â color: #333;
Â Â Â Â }
Â Â Â Â .current-list-label select {
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â color: #2c3e50;
Â Â Â Â Â Â background-color: #fff;
Â Â Â Â Â Â border: 1px solid #aaa;
Â Â Â Â }
Â Â Â Â .btn-pink {
Â Â Â Â Â Â background-color: #fcebeb;
Â Â Â Â Â Â color: #333;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â padding: 10px 16px;
Â Â Â Â Â Â font-size: 14px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â }
Â Â Â Â .btn-lightblue {
Â Â Â Â Â Â background-color: #e0f4ff;
Â Â Â Â Â Â color: #333;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â padding: 10px 16px;
Â Â Â Â Â Â font-size: 14px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â }
.slot-machine {
Â Â display: none; /* â† åˆå§‹ä¸é¡¯ç¤º */
Â Â height: 60px;
Â Â overflow: hidden;
Â Â position: relative;
Â Â margin: 30px auto 0;
Â Â width: 80%;
Â Â max-width: 300px;
Â Â background: white;
Â Â border-radius: 12px;
Â Â box-shadow: 0 4px 12px rgba(0,0,0,0.2);
Â Â font-size: 26px;
Â Â font-weight: bold;
Â Â text-align: center;
Â Â color: #b34400;
Â Â border: 3px dashed #ffe066;
Â Â opacity: 0;
Â Â transition: all 0.4s ease;
}
.slot-machine.show {
Â Â display: block;
Â Â opacity: 1;
}
.slot-content {
Â Â display: flex;
Â Â flex-direction: column;
Â Â animation: spinScroll 3.2s ease-out forwards;
}
@keyframes spinScroll {
Â Â 0% Â  { transform: translateY(0); }
Â Â 100% { transform: translateY(-100%); }
}
.current-list-label {
Â Â width: 100%;
Â Â margin: 10px 0;
}
.label-left {
Â Â text-align: left;
Â Â font-size: 1.2em;
Â Â margin-bottom: 4px;
Â Â padding-left: 12px;
}
.select-center {
Â Â display: flex;
Â Â justify-content: center;
Â Â width: 100%;
}
.select-center select {
Â Â min-width: 160px;
Â Â max-width: 80vw;
Â Â font-size: 1em;
Â Â text-align: center; Â  Â  Â  /* â† æ§åˆ¶é–‹å•Ÿä¸‹æ‹‰é¸å–®æ™‚çš„é¸é …ç½®ä¸­ */
Â Â text-align-last: center;Â  /* â† æ§åˆ¶å·²é¸æ–‡å­—åœ¨æ¡†ä¸­ç½®ä¸­ */
}
#effectSelectorContainer {
Â Â margin: 20px auto 0 auto;
Â Â text-align: center;
Â Â position: absolute;Â  /* âœ… åŠ é€™ä¸€è¡Œ */
Â Â width: 100%; Â  Â  Â  Â  /* âœ… å¯é¸ï¼Œç¢ºä¿ç½®ä¸­å°é½Š */
Â Â left: 0; Â  Â  Â  Â  Â  Â  /* âœ… å›ºå®šå·¦å´ */
}
#effectSelect {
Â Â appearance: none;
Â Â font-size: 16px;
Â Â padding: 10px 16px;
Â Â color: #666;
Â Â background-color: #f0f9ff;Â  /* èˆ‡æ•´é«”åº•è‰²çµ±ä¸€ */
Â Â border: none; Â  Â  Â  Â  Â  Â  Â  /* ç§»é™¤é‚Šæ¡† */
Â Â border-radius: 8px;
Â Â font-weight: 500;
Â Â width: auto;
Â Â max-width: 80vw;
Â Â text-align-last: center;
Â Â cursor: pointer;
Â Â box-shadow: 0 2px 4px rgba(0,0,0,0.05);
Â Â transition: background-color 0.2s ease, box-shadow 0.2s ease;
}
#effectSelect:hover {
Â Â background-color: #e0f4ff;
Â Â box-shadow: 0 4px 8px rgba(0,0,0,0.08);
}
#effectSelect:focus {
Â Â outline: none;
Â Â background-color: #d0ecff;
Â Â box-shadow: 0 0 0 3px rgba(61, 184, 196, 0.2);
}
.video-wrapper {
Â Â width: 100%;
Â Â max-width: 420px;
Â Â margin: 30px auto 20px auto;
Â Â position: relative;
Â Â overflow: hidden;
Â Â border-radius: 20px;
Â Â box-shadow: 0 0 20px rgba(255, 223, 0, 0.4);
Â Â pointer-events: none;
Â Â max-height: 240px;Â  Â  Â  Â  Â  /* âœ… é™åˆ¶æœ€å¤§é«˜åº¦ */
Â Â min-height: 200px; Â  Â  Â  /* âœ… é ç•™é«˜åº¦é¿å…ç•«é¢çªç„¶æ’é–‹ */
Â Â opacity: 0;Â  Â  Â  Â  Â  Â  Â  /* âœ… ä¸€é–‹å§‹éš±è— */
Â Â transition: opacity 0.3s ease;
}
.video-wrapper.show {
Â Â opacity: 1;Â  Â  Â  Â  Â  Â  Â  /* âœ… å‡ºç¾æ™‚æ·¡å…¥ */
}
.custom-video {
Â Â width: 100%;
Â Â height: 100%;
Â Â object-fit: cover;
Â Â border-radius: 20px;
Â Â mask-image: radial-gradient(circle at center, rgba(0,0,0,1) 60%, rgba(0,0,0,0) 100%);
Â Â mask-composite: exclude;
}
.video-wrapper.glow-out {
Â Â animation: glowOut 1s ease forwards;
}
@keyframes glowOut {
Â Â 0% {
Â Â Â Â box-shadow: 0 0 20px rgba(255, 200, 0, 0.6);
Â Â Â Â opacity: 1;
Â Â Â Â transform: scale(1);
Â Â }
Â Â 100% {
Â Â Â Â box-shadow: 0 0 80px rgba(255, 255, 0, 0.2);
Â Â Â Â opacity: 0;
Â Â Â Â transform: scale(1.4);
Â Â Â Â margin-bottom: -200px; /* â† å¼·åˆ¶å£“ç¸®ç©ºé–“ */
Â Â Â Â visibility: hidden;
Â Â }
}
@keyframes fadeIn {
Â Â from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
Â Â to Â  { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}
.result-card.transitioning {
Â Â opacity: 0;
Â Â transform: scale(0.9);
}
.result-card.reveal {
Â Â transition: all 0.6s ease;
Â Â opacity: 1;
Â Â transform: scale(1);
}
.btn-primary.disabled {
Â Â background-color: #ddd !important;
Â Â color: #999 !important;
Â Â cursor: not-allowed !important;
Â Â box-shadow: none !important;
Â Â transform: none !important;
}
.fade-out-smooth {
Â Â opacity: 0;
Â Â transition: opacity 0.6s ease;
}
.fade-in-smooth {
Â Â Â Â opacity: 1;
Â Â Â Â transition: opacity 0.6s ease;
Â Â Â Â visibility: visible; /* âœ… åŠ ä¸Šé€™è¡Œ */
}
@keyframes shake {
Â Â 0% { transform: translateX(0); }
Â Â 20% { transform: translateX(-6px); }
Â Â 40% { transform: translateX(6px); }
Â Â 60% { transform: translateX(-4px); }
Â Â 80% { transform: translateX(4px); }
Â Â 100% { transform: translateX(0); }
}
.shake {
Â Â animation: shake 0.4s;
Â Â will-change: transform; /* æå‰é€šçŸ¥ç€è¦½å™¨åŠ é€Ÿæ¸²æŸ“ï¼Œæ¸›å°‘æ’•è£‚ */
}
@keyframes dropAndShrink {
Â Â 0% {
Â Â Â Â opacity: 0;
Â Â Â Â transform: translateY(-150px) scale(1.4);
Â Â }
Â Â 50% {
Â Â Â Â opacity: 1;
Â Â Â Â transform: translateY(20px) scale(0.9);
Â Â }
Â Â 100% {
Â Â Â Â opacity: 1;
Â Â Â Â transform: translateY(0) scale(1);
Â Â }
}
.result-card.drop-in {
Â Â animation: dropAndShrink 0.7s ease forwards;
}
@keyframes fadeInEffectSelector {
Â Â 0% { opacity: 0; }
Â Â 100% { opacity: 1; }
}
.fade-in-anim {
Â Â animation: fadeInEffectSelector 0.6s ease forwards;
}
@keyframes fadeInEffectSelector {
Â Â 0% { opacity: 0; }
Â Â 100% { opacity: 1; }
}
.fade-in-anim {
Â Â animation: fadeInEffectSelector 0.6s ease forwards;
}
.fade-out-smooth {
Â Â opacity: 0;
Â Â transition: opacity 0.6s ease;
}
@keyframes refreshFadeScale {
Â Â 0% {
Â Â Â Â opacity: 0;
Â Â Â Â transform: scale(0.8);
Â Â Â Â filter: brightness(1.3);
Â Â }
Â Â 50% {
Â Â Â Â opacity: 1;
Â Â Â Â transform: scale(1.05);
Â Â Â Â filter: brightness(1);
Â Â }
Â Â 100% {
Â Â Â Â transform: scale(1);
Â Â Â Â filter: brightness(1);
Â Â }
}
.result-card.refresh-fade-scale {
Â Â animation: refreshFadeScale 0.5s ease;
}
body.dark-mode {
Â Â background-color: #1e1e1e;
Â Â color: #ddd;
}
body.dark-mode .nav {
Â Â background-color: #333;
}
body.dark-mode .nav button {
Â Â background-color: #555;
Â Â color: #eee;
}
body.dark-mode .nav button.active {
Â Â background-color: #888;
}
body.dark-mode .page {
Â Â background-color: #1e1e1e;
}
body.dark-mode h1 {
Â Â color: #eee;
}
body.dark-mode .btn-primary {
Â Â background-color: #555;
Â Â color: #ddd;
}
body.dark-mode .btn-primary:hover {
Â Â background-color: #666;
}
body.dark-mode .btn-pink {
Â Â background-color: #664;
Â Â color: #ddd;
}
body.dark-mode .btn-lightblue {
Â Â background-color: #334;
Â Â color: #ddd;
}
body.dark-mode input,
body.dark-mode select,
body.dark-mode button {
Â Â background-color: #333;
Â Â color: #ddd;
Â Â border: 1px solid #555;
}
body.dark-mode li {
Â Â background: #333;
Â Â color: #ddd;
}
body.dark-mode .result-card {
Â Â background: linear-gradient(145deg, #333, #444);
Â Â color: #ffe066;
}
body.dark-mode #effectSelect {
Â Â background-color: #333;
Â Â color: #ddd;
}
body.dark-mode .slot-machine {
Â Â background-color: #333;
Â Â color: #ffe066;
Â Â border-color: #555;
}
body.dark-mode .footer-note {
Â Â color: #666;
}

body.dark-mode #sortModal > div {
Â Â background: #2b2b2b !important; /* æ·±ç°èƒŒæ™¯ */
Â Â color: #ddd !important; Â  Â  Â  Â  /* æŸ”å’Œæ·ºå­— */
Â Â border: 1px solid #444; Â  Â  Â  Â  /* å¯é¸ï¼šå¢åŠ åˆ†ç•Œæ„Ÿ */
}

body.dark-mode #sortModal h3 {
Â Â color: #eee !important; Â  Â  Â  Â  /* æ¨™é¡Œæ›´äº® */
}

body.dark-mode #sortModal button {
Â Â background-color: #444 !important;
Â Â color: #eee !important;
Â Â border: 1px solid #555 !important;
}

body.dark-mode #sortModal button:hover {
Â Â background-color: #555 !important;
Â Â color: #2b2b2b !important;
}
body.dark-mode #sortModal li {
Â Â background: #3a3a3a !important; /* æ·±ç°èƒŒæ™¯ï¼Œèˆ‡æ•´é«”æ·±è‰²ä¸€è‡´ */
Â Â color: #fff !important; Â  Â  Â  Â  /* ç™½å­—ï¼Œæ¸…æ™°å¯è¦‹ */
Â Â border: 1px solid #555; Â  Â  Â  Â  /* å¯å¢åŠ åˆ†éš”æ„Ÿ */
}

body.dark-mode #sortModal li:hover {
Â Â background: #4a4a4a !important; /* æ»‘éæ™‚åŠ äº® */
}

Â Â </style>
</head>
<body>
<button id="darkModeToggle" title="åˆ‡æ›æ·±è‰²æ¨¡å¼" style="
Â Â position: fixed;
Â Â top: 10px;
Â Â right: 10px;
Â Â z-index: 999;
Â Â background: #fff;
Â Â border: none;
Â Â border-radius: 50%;
Â Â width: 36px;
Â Â height: 36px;
Â Â font-size: 18px;
Â Â cursor: pointer;
Â Â box-shadow: 0 2px 6px rgba(0,0,0,0.2);
Â Â display: flex;
Â Â align-items: center;
Â Â justify-content: center;
">ğŸŒ™</button>
<h1><img src="https://cdn.jsdelivr.net/gh/a355226/choosehelper@main/icon.png" alt="icon" width="32">
é¸æ“‡å°å¹«æ‰‹</h1>
<div class="nav">
Â Â <button class="active" onclick="showPage('randomPage')">ğŸ¯ å¿«é€Ÿæ±ºå®š</button>
Â Â <button onclick="showPage('editPage')">ğŸ“ ç·¨è¼¯æ¸…å–®</button>
</div>
<div class="page active" id="randomPage">
Â Â <div class="current-list-label">
Â Â <div class="label-left">ç›®å‰æ¸…å–®ï¼š</div>
Â Â <div class="select-center">
Â Â Â Â <select id="topMemorySelect" onchange="switchMemoryFromTop()">
Â Â Â Â Â Â <option value="">-- è«‹é¸æ“‡ --</option>
Â Â Â Â </select>
Â Â </div>
Â Â </div>
Â Â <div class="random-container">
Â Â Â Â <button class="btn-primary" style="width:100%; font-size:20px;" onclick="chooseRandom()">ğŸ² éš¨æ©Ÿé¸ ğŸ²</button>
Â Â Â Â <div id="resultCard" class="result-card">è«‹å…ˆå»ºç«‹æ¸…å–®</div>
<div id="slotMachine" class="slot-machine"></div>
Â Â Â Â <div id="appealArea"></div>
Â Â </div>
</div>
Â Â <div id="effectSelectorContainer" style="margin-top: 80px; text-align: center;">
Â Â <label for="effectSelect" style="font-weight: bold;"></label>
<select id="effectSelect" onchange="handleEffectChange()">
Â Â <option value="default">é è¨­</option>
Â Â <option value="video001">ææ€–è²å­</option>
Â Â <option value="video002">å¾·å·æ’²å…‹</option>
Â Â <option value="video003">å¯æ„›è²“å’ª</option>
Â Â <option value="video004">å¤–æ˜Ÿç”Ÿç‰©</option>
Â Â <option value="video005">å°¾ç‰™æŠ½ç</option>
Â Â <option value="random">éš¨æ©Ÿ</option>
</select>
</div>
<div class="page" id="editPage">
Â Â <div class="section-title">ğŸ“‚ åˆ‡æ›æ¸…å–®ï¼š</div>
Â Â <select id="memorySelect" onchange="loadMemoryList()">
Â Â Â Â <option value="">-- è«‹é¸æ“‡ --</option>
Â Â </select>
<button class="btn-lightblue" onclick="openSortModal()">ğŸ”ƒæ’åº</button>
Â Â <button class="btn-pink" onclick="deleteMemoryList()">ğŸ—‘ åˆªé™¤æ¸…å–®</button>
Â Â <div class="section-title">ğŸ–Š è¼¸å…¥é …ç›®ï¼š</div>
Â Â <input type="text" id="foodInput" placeholder="è«‹è¼¸å…¥" />
Â Â <button class="btn-primary" onclick="addFood()">åŠ å…¥</button>
Â Â <button class="btn-lightblue" onclick="saveCurrentList()">å»ºç«‹</button>
Â Â <button class="btn-lightblue" onclick="updateCurrentList()">æ›´æ–°</button>
Â Â <button class="btn-pink"Â  onclick="clearAllItems()">å…¨éƒ¨æ¸…é™¤</button>
Â Â <div class="section-title">ğŸ“ƒ ç›®å‰æ¸…å–®ï¼š</div>
Â Â <ul id="foodList"></ul>
Â Â <div style="margin-top: 70px;">
<button class="btn-lightblue" onclick="openExportImportModal()">åŒ¯å‡º / åŒ¯å…¥</button>

Â Â </div>
</div>
<script>
let currentSortable = null; // å…¨åŸŸä¿å­˜ Sortable å¯¦ä¾‹
window._introPlayed = false; // âœ… ç”¨æ–¼æ§åˆ¶åˆ‡é æ™‚å‹•ç•«åªè·‘ä¸€æ¬¡
window._introPlayed = false;
let currentList = [];
let memoryData = JSON.parse(localStorage.getItem('memoryData')) || {};
let currentListName = "";
function showPage(id) {
Â Â Â Â document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
Â Â Â Â document.getElementById(id).classList.add('active');
Â Â Â Â document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
Â Â Â Â const btn = id === 'randomPage' ? document.querySelectorAll('.nav button')[0] : document.querySelectorAll('.nav button')[1];
Â Â Â Â btn.classList.add('active');
Â Â Â Â if (id === 'randomPage') {
Â Â Â Â Â Â Â Â const slotMachine = document.getElementById('slotMachine');
Â Â Â Â Â Â Â Â const resultCard = document.getElementById('resultCard');
Â Â Â Â Â Â Â Â const appealArea = document.getElementById('appealArea');
Â Â Â Â Â Â Â Â slotMachine.innerHTML = '';
Â Â Â Â Â Â Â Â slotMachine.classList.remove('show');
Â Â Â Â Â Â Â Â if (!currentListName || currentList.length === 0) {
Â Â Â Â Â Â Â Â Â Â Â Â resultCard.textContent = 'å…ˆé¸æ“‡æ¸…å–®';
Â Â Â Â Â Â Â Â } else {
Â Â Â Â Â Â Â Â Â Â Â Â resultCard.textContent = `ä¾†æ±ºå®šã€Œ${currentListName}ã€!`;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â resultCard.classList.remove('glow', 'show');
Â Â Â Â Â Â Â Â appealArea.innerHTML = '';
Â Â Â Â Â Â Â Â enableRandomButton();
Â Â Â Â Â Â Â Â // åŒæ­¥ä¸‹æ‹‰é¸å–®é¡¯ç¤ºç‹€æ…‹
const topMemorySelect = document.getElementById('topMemorySelect');
if (!currentListName) {
Â Â Â Â topMemorySelect.value = "";
} else {
Â Â Â Â topMemorySelect.value = currentListName;
}
Â Â Â Â Â Â Â Â // âœ… åƒ…ç¬¬ä¸€æ¬¡åˆ‡æ›æ™‚æ’­æ”¾å‹•ç•«ï¼Œé¿å…å¤šæ¬¡æ’ç¨‹éŒ¯äº‚
Â Â Â Â Â Â Â Â if (!window._introPlayed) {
Â Â Â Â Â Â Â Â Â Â Â Â window._introPlayed = true; // âš¡ï¸ æ¨™è¨˜å·²è§¸ç™¼
Â Â Â Â Â Â Â Â Â Â Â Â setTimeout(() => {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â revealIntroText();
Â Â Â Â Â Â Â Â Â Â Â Â }, 300);
Â Â Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â const effectContainer = document.getElementById('effectSelectorContainer');
Â Â Â Â effectContainer.style.display = (id === 'randomPage') ? 'block' : 'none';
}
function saveMemoryData() {
Â Â localStorage.setItem('memoryData', JSON.stringify(memoryData));
}
function addFood() {
Â Â const input = document.getElementById('foodInput');
Â Â const food = input.value.trim();
Â Â if (food) {
Â Â Â Â currentList.push(food);
Â Â Â Â input.value = '';
Â Â Â Â renderCurrentList();
Â Â }
}
function renderCurrentList() {
Â Â const ul = document.getElementById('foodList');
Â Â ul.innerHTML = '';
Â Â currentList.forEach((item, index) => {
Â Â Â Â const li = document.createElement('li');
Â Â Â Â const span = document.createElement('span');
Â Â Â Â span.textContent = item;
Â Â Â Â const btn = document.createElement('button');
Â Â Â Â btn.textContent = 'âœ•';
Â Â Â Â btn.className = 'remove-btn';
Â Â Â Â btn.onclick = () => removeItem(index);
Â Â Â Â li.appendChild(span);
Â Â Â Â li.appendChild(btn);
Â Â Â Â ul.appendChild(li);
Â Â });
}
function removeItem(index) {
Â Â currentList.splice(index, 1);
Â Â renderCurrentList();
}
function clearAllItems() {
Â Â if (confirm("ç¢ºå®šè¦æ¸…é™¤ç›®å‰æ‰€æœ‰é …ç›®ï¼Ÿ")) {
Â Â Â Â currentList = [];
Â Â Â Â renderCurrentList();
Â Â }
}
function saveCurrentList() {
Â Â const name = prompt("è«‹è¼¸å…¥æ­¤æ¸…å–®çš„åç¨±ï¼š");
Â Â if (name && name.trim()) {
Â Â Â Â memoryData[name] = [...currentList];
Â Â Â Â currentListName = name;
Â Â Â Â saveMemoryData();
Â Â Â Â // ğŸ”¸ä¿®æ­£ï¼šæ’å…¥æ–°åç¨±åˆ° memoryOrder ä¸¦å­˜å›
Â Â Â Â let memoryOrder = [];
Â Â Â Â try { memoryOrder = JSON.parse(localStorage.getItem('memoryOrder')) || []; } catch {}
Â Â Â Â if (!memoryOrder.includes(name)) {
Â Â Â Â Â Â memoryOrder.push(name);
Â Â Â Â Â Â localStorage.setItem('memoryOrder', JSON.stringify(memoryOrder));
Â Â Â Â }
Â Â Â Â updateMemorySelect();
Â Â Â Â alert(`å·²è¨˜æ†¶æ¸…å–®ï¼šã€Œ${name}ã€`);
Â Â }
}
function loadMemoryList() {
Â Â const selected = document.getElementById('memorySelect').value;
Â Â if (!selected) {
Â Â Â Â currentList = [];
Â Â Â Â currentListName = "";
Â Â Â Â renderCurrentList();
Â Â Â Â return;
Â Â }
Â Â if (memoryData[selected]) {
Â Â Â Â currentList = [...memoryData[selected]];
Â Â Â Â currentListName = selected;
Â Â Â Â updateMemorySelect();
Â Â Â Â renderCurrentList();
Â Â }
}
function switchMemoryFromTop() {
Â Â const selected = document.getElementById('topMemorySelect').value;
Â Â if (!selected) {
Â Â Â Â currentList = [];
Â Â Â Â currentListName = "";
Â Â Â Â renderCurrentList();
Â Â Â Â return;
Â Â }
Â Â if (memoryData[selected]) {
Â Â Â Â currentList = [...memoryData[selected]];
Â Â Â Â currentListName = selected;
Â Â Â Â updateMemorySelect();
Â Â Â Â renderCurrentList();
Â Â }
}
function deleteMemoryList() {
Â Â const selected = document.getElementById('memorySelect').value;
Â Â if (selected && memoryData[selected]) {
Â Â Â Â if (confirm(`ç¢ºå®šè¦åˆªé™¤è¨˜æ†¶æ¸…å–®ï¼šã€Œ${selected}ã€ï¼Ÿ`)) {
Â Â Â Â Â Â delete memoryData[selected];
Â Â Â Â Â Â if (currentListName === selected) {
Â Â Â Â Â Â Â Â currentListName = "";
Â Â Â Â Â Â Â Â currentList = [];
Â Â Â Â Â Â Â Â renderCurrentList();
Â Â Â Â Â Â }
Â Â Â Â Â Â saveMemoryData();
Â Â Â Â Â Â updateMemorySelect();
Â Â Â Â Â Â alert(`ã€Œ${selected}ã€å·²åˆªé™¤`);
Â Â Â Â }
Â Â } else {
Â Â Â Â alert("è«‹å…ˆé¸æ“‡è¦åˆªé™¤çš„æ¸…å–®");
Â Â }
}
function shareList() {
Â Â const text = JSON.stringify({ name: currentListName, items: currentList });
Â Â if (navigator.share) {
Â Â Â Â navigator.share({
Â Â Â Â Â Â title: 'æˆ‘çš„é¸æ“‡æ¸…å–®',
Â Â Â Â Â Â text: text
Â Â Â Â }).catch(err => alert("åˆ†äº«å¤±æ•—ï¼š" + err));
Â Â } else {
Â Â Â Â prompt("è«‹è¤‡è£½ä»¥ä¸‹å…§å®¹ä»¥åˆ†äº«ï¼š", text);
Â Â }
}
function importList() {
Â Â const text = prompt("è«‹è²¼ä¸Šåˆ†äº«å…§å®¹ï¼š");
Â Â if (!text) return;
Â Â try {
Â Â Â Â const parsed = JSON.parse(text);
Â Â Â Â if (!parsed.name || !Array.isArray(parsed.items)) throw new Error("æ ¼å¼éŒ¯èª¤");
Â Â Â Â memoryData[parsed.name] = parsed.items;
Â Â Â Â currentListName = parsed.name;
Â Â Â Â currentList = [...parsed.items];
Â Â Â Â saveMemoryData();

Â Â Â Â // âœ… ä¿®æ­£ï¼šæ’å…¥åŒ¯å…¥åç¨±åˆ°è¨˜æ†¶é †åº
Â Â Â Â let memoryOrder = [];
Â Â Â Â try { memoryOrder = JSON.parse(localStorage.getItem('memoryOrder')) || []; } catch {}
Â Â Â Â if (!memoryOrder.includes(parsed.name)) {
Â Â Â Â Â Â Â Â memoryOrder.push(parsed.name);
Â Â Â Â Â Â Â Â localStorage.setItem('memoryOrder', JSON.stringify(memoryOrder));
Â Â Â Â }

Â Â Â Â updateMemorySelect();
Â Â Â Â renderCurrentList();
Â Â Â Â alert(`æˆåŠŸåŒ¯å…¥æ¸…å–®ï¼šã€Œ${parsed.name}ã€`);
Â Â } catch (e) {
Â Â Â Â alert("âŒ åŒ¯å…¥å¤±æ•—ï¼šæ ¼å¼éŒ¯èª¤");
Â Â }
}

// åˆå§‹åŒ–
updateMemorySelect();
renderCurrentList();
// âœ… ä¿®æ­£ï¼šæ¢å¾©ä¸Šæ¬¡ä½¿ç”¨çš„ç‰¹æ•ˆï¼ˆè®“ effectSelect è¨˜ä½ä½¿ç”¨è€…é¸æ“‡ï¼‰
const lastEffect = localStorage.getItem('lastEffect') || 'default';
document.getElementById('effectSelect').value = lastEffect;
let appealCount = 3;
let lastIndex = -1; // è¨˜éŒ„ä¸Šæ¬¡çš„çµæœä½ç½®
function secureRandomIndex(max) {
Â Â const arr = new Uint32Array(1);
Â Â window.crypto.getRandomValues(arr);
Â Â return Math.floor(arr[0] / (2**32) * max);
}
function chooseRandom(isAppeal = false) {window._introPlayed = false; // âœ… é»æ“ŠæŠ½ç±¤å¾Œï¼Œä¸‹æ¬¡åˆ‡é æœƒé‡æ–°æ’­æ”¾å‹•ç•«
window._resultShown = false; // âœ… æ¯æ¬¡æŠ½é¸å‰é‡ç½®
Â Â if (!currentListName || currentList.length === 0) {
Â Â Â Â const randomBtn = document.querySelector('.btn-primary');
Â Â Â Â randomBtn.classList.add('shake');
Â Â Â Â // åŒæ™‚å½ˆå‡ºæç¤º
Â Â Â Â setTimeout(() => {
Â Â Â Â Â Â alert("ğŸš« è«‹å…ˆé¸æ“‡æ¸…å–®");
Â Â Â Â Â Â randomBtn.classList.remove('shake');
Â Â Â Â }, 50);
Â Â Â Â return;
Â Â }Â 
Â Â randomBtn.classList.add('disabled');
Â Â randomBtn.disabled = true;
Â Â const resultCard = document.getElementById('resultCard');
Â Â const appealArea = document.getElementById('appealArea');
Â Â const slotMachine = document.getElementById('slotMachine');
Â Â const effectContainer = document.getElementById('effectSelectorContainer'); // â† æ–°å¢
Â slotMachine.style.display = '';Â 
Â Â let effect = document.getElementById('effectSelect')?.value || 'default';
// å¦‚æœæ˜¯éš¨æ©Ÿï¼Œå¾ default èˆ‡ 5 å€‹å½±ç‰‡éš¨æ©Ÿé¸ä¸€å€‹
if (effect === 'random') {
Â Â Â Â const options = ['default', 'video001', 'video002', 'video003', 'video004', 'video005'];
Â Â Â Â effect = options[Math.floor(Math.random() * options.length)];
}
Â Â if (!isAppeal) appealCount = 3;
Â Â appealArea.innerHTML = '';
Â Â // â¤ æ¸…é™¤å½±ç‰‡å€
Â Â const oldWrapper = document.querySelector('.video-wrapper');
Â Â if (oldWrapper) oldWrapper.remove();
Â Â // â¤ é‡ç½®æ‹‰éœ¸å‹•ç•«
Â Â slotMachine.innerHTML = '';
Â Â slotMachine.classList.remove('show');
// âœ… åƒ…ç¬¬ä¸€æ¬¡éš¨æ©Ÿé¸ / ä¸Šè¨´æ™‚æ·¡å‡ºï¼Œä¹‹å¾Œéç¨‹ä¸­ä¸æœƒå†æ¬¡æ·¡å‡º
if (effectContainer.style.display !== 'none') {
Â Â Â Â effectContainer.classList.remove('fade-in-smooth', 'fade-in-anim');
Â Â Â Â effectContainer.classList.add('fade-out-smooth');
Â Â Â Â setTimeout(() => {
Â Â Â Â Â Â Â Â effectContainer.style.visibility = 'hidden';
Â Â Â Â Â Â Â Â effectContainer.classList.remove('fade-out-smooth');
Â Â Â Â }, 600);
}
if (['video001', 'video002', 'video003', 'video004', 'video005'].includes(effect)) {
Â Â Â Â resultCard.style.display = 'none';
Â Â Â Â Â Â Â Â let finalIndex = secureRandomIndex(currentList.length); // âœ… æ–°å¢
Â Â Â Â lastIndex = finalIndex; // âœ… æ–°å¢
Â Â Â Â playVideoEffect(resultCard, effect);
} else {
Â Â Â Â // âœ… æ‹‰éœ¸å‰è¨˜éŒ„ç©©å®šä½ç½®ï¼ˆé¦–æ¬¡åŸ·è¡Œæ™‚è¨˜éŒ„ï¼‰
Â Â Â Â if (!window.effectSelectorStableTop) {
Â Â Â Â Â Â Â Â const rect = effectContainer.getBoundingClientRect();
Â Â Â Â Â Â Â Â const scrollTop = window.scrollY || window.pageYOffset;
Â Â Â Â Â Â Â Â window.effectSelectorStableTop = rect.top + scrollTop;
Â Â Â Â }
Â Â Â Â // âœ… ä½¿ç”¨ç©©å®šä½ç½®é–å®š Effect Selectorï¼Œé¿å…è¢«æ¨ä¸‹
Â Â Â Â effectContainer.style.position = 'fixed';
Â Â Â Â effectContainer.style.top = window.effectSelectorStableTop + 'px';
Â Â Â Â resultCard.textContent = 'ğŸ° æ­£åœ¨æŠ½ç±¤...';
Â Â Â Â resultCard.classList.add('show', 'glow');
Â Â Â Â runSlotAnimation();
}
}
function updateCurrentList() {
Â Â if (!currentListName) {
Â Â Â Â alert("âš ï¸ å°šæœªé¸æ“‡ä»»ä½•è¨˜æ†¶æ¸…å–®ï¼Œè«‹å…ˆé¸æ“‡ä¸€å€‹è¦æ›´æ–°çš„æ¸…å–®");
Â Â Â Â return;
Â Â }
Â Â memoryData[currentListName] = [...currentList];
Â Â saveMemoryData();
Â Â alert(`âœ… å·²æ›´æ–°æ¸…å–®ï¼šã€Œ${currentListName}ã€`);
Â Â updateMemorySelect();// å¯é¸ï¼Œæœ‰æ™‚å€™æœƒåˆ·æ–°ä¸‹æ‹‰é¸å–®é¡¯ç¤ºç‹€æ…‹
// âœ… å¥—ç”¨ä¸Šæ¬¡ä½¿ç”¨çš„ç‰¹æ•ˆ
const lastEffect = localStorage.getItem('lastEffect') || 'default';
const effectSelect = document.getElementById('effectSelect');
if (effectSelect) {
Â Â Â Â effectSelect.value = lastEffect;
}
}
Â function runSlotAnimation() {
Â Â // âœ… åŸ·è¡Œæ‹‰éœ¸å‰å›ºå®š Effect Selector ä½ç½®é¿å…è·³å‹•
const effectContainer = document.getElementById('effectSelectorContainer');
Â Â const slotMachine = document.getElementById('slotMachine');
Â Â const resultCard = document.getElementById('resultCard');
Â Â const appealArea = document.getElementById('appealArea');
Â Â let finalIndex = secureRandomIndex(currentList.length);
Â Â lastIndex = finalIndex;
Â Â const spinList = [];
Â Â for (let i = 0; i < 90; i++) {
Â Â Â Â spinList.push(currentList[secureRandomIndex(currentList.length)]);
Â Â }
Â Â spinList.push(currentList[finalIndex]);
Â Â const slotContent = document.createElement('div');
Â Â slotContent.className = 'slot-content';
Â Â slotContent.style.animation = 'none';
Â Â slotContent.innerHTML = spinList.map(item => `<div>${item}</div>`).join('');
Â Â slotMachine.innerHTML = '';
Â Â slotMachine.appendChild(slotContent);
Â Â slotMachine.classList.add('show');
Â Â void slotContent.offsetWidth;
Â Â slotContent.style.animation = 'spinScroll 3.2s ease-out forwards';
Â Â setTimeout(() => {
Â Â Â Â revealResult();
Â Â }, 3300);
}
function revealResult(currentEffect)Â  {
console.log('[DEBUG] revealResult currentEffect =', currentEffect);
if (window._revealRunning) return;
window._revealRunning = true;
setTimeout(() => window._revealRunning = false, 1500);
Â Â Â Â const effectContainer = document.getElementById('effectSelectorContainer');
Â Â Â Â const resultCard = document.getElementById('resultCard');
Â Â Â Â const appealArea = document.getElementById('appealArea');
Â Â Â Â const slotMachine = document.getElementById('slotMachine');
Â Â Â Â // âœ… ä¿®æ­£ï¼šå…ˆæ¸…é™¤ refresh-fade-scaleï¼Œé¿å…æ±¡æŸ“å½±ç‰‡ç‰¹æ•ˆ
Â Â Â Â resultCard.classList.remove('refresh-fade-scale');
Â Â // æ¸¬é‡ç©©å®šä½ç½®ä¸€æ¬¡è¨˜éŒ„
Â Â if (!window.effectSelectorStableTop) {
Â Â Â Â const rect = effectContainer.getBoundingClientRect();
Â Â Â Â const scrollTop = window.scrollY || window.pageYOffset;
Â Â Â Â window.effectSelectorStableTop = rect.top + scrollTop;
Â Â }
Â Â setTimeout(() => {
Â Â Â Â resultCard.style.display = '';
}, 50);
Â if (lastIndex < 0) {
Â Â Â Â lastIndex = secureRandomIndex(currentList.length);
}
const finalIndex = lastIndex;
resultCard.textContent = `ğŸ‰ ${currentList[finalIndex]}`;
window._resultShown = true; // âœ… æ¨™è¨˜çµæœå·²é¡¯ç¤º
requestAnimationFrame(() => {
Â Â Â Â requestAnimationFrame(() => {
Â Â Â Â Â Â Â Â resultCard.classList.add('show', 'glow', 'drop-in');
Â Â Â Â Â Â Â Â // åªæœ‰åœ¨éœ€è¦æ™‚åŠ ä¸Š refresh-fade-scale
Â Â Â Â Â Â Â Â if (currentEffect === 'default' || currentEffect === 'random') {
Â Â Â Â Â Â Â Â Â Â Â Â resultCard.classList.add('refresh-fade-scale');
Â Â Â Â Â Â Â Â }
Â Â Â Â });
});
resultCard.classList.remove('drop-in');
requestAnimationFrame(() => {
Â Â Â Â requestAnimationFrame(() => {
Â Â Â Â Â Â Â Â resultCard.classList.add('show', 'glow', 'drop-in');
Â Â Â Â });
});
Â Â Â Â // âœ… ä¿®æ­£æ ¸å¿ƒï¼šé¡¯å¼ä½¿ç”¨å‚³å…¥çš„ currentEffect
Â Â Â Â currentEffect = currentEffect || document.getElementById('effectSelect').value;
Â Â Â Â if (currentEffect === 'default' || currentEffect === 'random') {
Â Â Â Â Â Â Â Â resultCard.classList.remove('refresh-fade-scale');
Â Â Â Â Â Â Â Â void resultCard.offsetWidth;
Â Â Â Â Â Â Â Â resultCard.classList.add('refresh-fade-scale');
Â Â Â Â }
Â Â // âœ… åˆ·æ–°ç‰¹æ•ˆï¼šåœ¨çµæœé¡¯ç¤ºæ™‚å¥—ç”¨ä¸€æ¬¡åˆ·æ–°å‹•ç•«
Â Â resultCard.classList.add('refresh-pulse');
Â Â resultCard.addEventListener('animationend', () => {
Â Â Â Â resultCard.classList.remove('refresh-pulse');
Â Â }, { once: true });
Â // å°‡æ’å…¥ä¸Šè¨´æŒ‰éˆ•çš„ç¨‹å¼ç¢¼å»¶å¾Œåˆ°å‹•ç•«å®Œå…¨å®Œæˆå¾Œå†æ’å…¥
setTimeout(() => {
Â Â Â Â if (appealCount > 0) {
Â Â Â Â Â Â Â Â const btn = document.createElement('button');
Â Â Â Â Â Â Â Â btn.textContent = `ä¸Šè¨´ï¼ï¼ˆå‰©é¤˜${appealCount}æ¬¡ï¼‰`;
Â Â Â Â Â Â Â Â btn.className = 'btn-pink';
Â Â Â Â Â Â Â Â btn.style.marginTop = '20px';
Â Â Â Â Â Â Â Â btn.style.backgroundColor = ['#ffe6e6', '#ffb3b3', '#ff6666'][3 - appealCount] || '#ff6666';
Â Â Â Â Â Â Â Â btn.style.color = '#800000';
Â Â Â Â Â Â Â Â btn.onclick = () => {
Â Â Â Â Â Â Â Â Â Â Â Â appealCount--;
Â Â Â Â Â Â Â Â Â Â Â Â chooseRandom(true);
Â Â Â Â Â Â Â Â };
Â Â Â Â Â Â Â Â appealArea.appendChild(btn);
Â Â Â Â } else {
Â Â Â Â Â Â Â Â const finalText = document.createElement('div');
Â Â Â Â Â Â Â Â finalText.textContent = 'èªå‘½å§ï¼Œé€™å°±æ˜¯æœ€å¥½çš„é¸æ“‡ï¼';
Â Â Â Â Â Â Â Â finalText.style.marginTop = '20px';
Â Â Â Â Â Â Â Â finalText.style.fontWeight = 'bold';
Â Â Â Â Â Â Â Â finalText.style.color = '#b34400';
Â Â Â Â Â Â Â Â appealArea.appendChild(finalText);
Â Â Â Â }
}, 50); // å»ºè­°å»¶é² 600~800 msï¼Œèˆ‡å‹•ç•«æ™‚é–“å°é½Š
Â Â enableRandomButton();
Â Â // âœ… æ·¡å‡º slot-machine
Â Â slotMachine.classList.remove('show');
Â Â slotMachine.style.display = 'none';
Â Â // æ‹‰éœ¸çµæŸå¾Œæ¢å¾©åŸæœ¬å®šä½
Â Â effectContainer.style.position = 'absolute';
Â Â effectContainer.style.top = '';
Â Â delete window.effectSelectorStableTop; // âœ… æ¢å¾©å¾Œæ¸…é™¤æš«å­˜
Â Â // âœ… ä¿®æ­£æ·¡å…¥æ•ˆæœç¢ºå¯¦è§¸ç™¼
setTimeout(() => {
Â Â Â Â effectContainer.classList.remove('fade-in-anim', 'fade-in-smooth', 'fade-out-smooth');
Â Â Â Â effectContainer.style.visibility = 'visible';
Â Â Â Â void effectContainer.offsetWidth;Â  Â  Â  Â  Â  Â  Â  Â  // å¼·åˆ¶é‡æ’ä»¥ç¢ºä¿å‹•ç•«è§¸ç™¼
Â Â Â Â effectContainer.classList.add('fade-in-anim'); Â  // åŸ·è¡Œå‹•ç•«
}, 100);
}
Â Â const v = Date.now(); // æ¯æ¬¡åˆ·æ–°éƒ½å¸¶å…¥å”¯ä¸€å€¼ï¼Œé¿é–‹å¿«å–
document.querySelectorAll('link[rel="icon"], link[rel="manifest"]').forEach(el => {
Â Â if (el.href) {
Â Â Â Â el.href += (el.href.includes('?') ? '&' : '?') + 'v=' + v;
Â Â }
});
if ('serviceWorker' in navigator) {
Â Â navigator.serviceWorker.register('/service-worker.js?v=' + v)
Â Â Â Â .then(reg => console.log('SW è¨»å†ŠæˆåŠŸ', reg.scope))
Â Â Â Â .catch(err => console.log('SW è¨»å†Šå¤±æ•—', err));
}
const randomBtn = document.querySelector('.btn-primary');
randomBtn.classList.remove('disabled');
randomBtn.disabled = false;
function enableRandomButton() {
Â Â const randomBtn = document.querySelector('.btn-primary');
Â Â randomBtn.classList.remove('disabled');
Â Â randomBtn.disabled = false;
}
function fadeOutAndHide(element) {
Â Â Â Â element.classList.add('fade-out-smooth');
}
function playVideoEffect(resultCard, effect) {
Â Â Â Â const wrapper = document.createElement('div');
Â Â Â Â wrapper.className = 'video-wrapper';
Â Â Â Â document.querySelector('.random-container').insertBefore(wrapper, resultCard);
Â Â Â Â const video = document.createElement('video');
Â Â Â Â const videoMap = {
Â Â Â Â 'video001': 'https://cdn.jsdelivr.net/gh/a355226/choosehelper@main/video001.mp4',
Â Â Â Â 'video002': 'https://cdn.jsdelivr.net/gh/a355226/choosehelper@main/video002.mp4',
Â Â Â Â 'video003': 'https://cdn.jsdelivr.net/gh/a355226/choosehelper@main/video003.mp4',
Â Â Â Â 'video004': 'https://cdn.jsdelivr.net/gh/a355226/choosehelper@main/video004.mp4',
Â Â Â Â 'video005': 'https://cdn.jsdelivr.net/gh/a355226/choosehelper@main/video005.mp4',
};
video.src = videoMap[effect] || videoMap['video001'];
Â Â Â Â video.autoplay = true;
Â Â Â Â video.playsInline = true;
Â Â Â Â video.muted = true;
Â Â Â Â video.className = "custom-video";
Â Â Â Â wrapper.appendChild(video);
// âœ… æ’­æ”¾å½±ç‰‡å‰å›ºå®š Effect Selector ä½ç½®é¿å…è·³å‹•
const effectContainer = document.getElementById('effectSelectorContainer');
const rect = effectContainer.getBoundingClientRect();
const scrollTop = window.scrollY || window.pageYOffset;
effectContainer.style.position = 'fixed';
effectContainer.style.top = (rect.top + scrollTop) + 'px';
Â Â Â Â // å‡ºç¾å‹•ç•«
Â Â Â Â setTimeout(() => {
Â Â Â Â Â Â Â Â wrapper.classList.add('show');
Â Â Â Â }, 50);
video.onended = () => {
Â Â Â Â wrapper.classList.add('glow-out');
Â Â Â Â setTimeout(() => {
Â Â Â Â Â Â Â Â wrapper.remove();
Â Â Â Â Â Â Â Â // âœ… æ’­æ”¾å½±ç‰‡å¾Œæ¢å¾©åŸæœ¬å®šä½
Â Â Â Â Â Â Â Â effectContainer.style.position = 'absolute';
Â Â Â Â Â Â Â Â effectContainer.style.top = '';
Â Â Â Â Â Â Â Â revealResult(effect);// é¡¯ç¤ºæœ€çµ‚çµæœ
Â Â Â Â }, 1000);
};
}
Â Â function handleEffectChange() {
Â Â Â Â const effect = document.getElementById('effectSelect').value;
Â Â Â Â localStorage.setItem('lastEffect', effect);
}
// æ·±è‰²æ¨¡å¼åˆ‡æ›èˆ‡è¨˜æ†¶
const darkModeToggle = document.getElementById('darkModeToggle');
if (localStorage.getItem('darkMode') === 'enabled') {
Â Â document.body.classList.add('dark-mode');
Â Â darkModeToggle.textContent = 'â˜€ï¸';
}
darkModeToggle.addEventListener('click', () => {
Â Â document.body.classList.toggle('dark-mode');
Â Â if (document.body.classList.contains('dark-mode')) {
Â Â Â Â localStorage.setItem('darkMode', 'enabled');
Â Â Â Â darkModeToggle.textContent = 'â˜€ï¸';
Â Â } else {
Â Â Â Â localStorage.setItem('darkMode', 'disabled');
Â Â Â Â darkModeToggle.textContent = 'ğŸŒ™';
Â Â }
});
// æ’åº Modal é–‹å•Ÿ
function openSortModal() {
Â Â document.body.style.overflow = 'hidden';
Â Â Â Â const sortList = document.getElementById('sortList');
Â Â Â Â sortList.innerHTML = '';
let memoryOrder = [];
try {
Â Â Â Â memoryOrder = JSON.parse(localStorage.getItem('memoryOrder')) || [];
} catch (e) {
Â Â Â Â memoryOrder = [];
}
if (!Array.isArray(memoryOrder) || memoryOrder.length === 0) {
Â Â Â Â memoryOrder = Object.keys(memoryData);
}

memoryOrder.forEach(name => {
Â Â Â Â if (memoryData[name]) {
Â Â Â Â Â Â Â Â const li = document.createElement('li');
Â Â Â Â Â Â Â Â li.textContent = name;
Â Â Â Â Â Â Â Â li.style.padding = '8px';
Â Â Â Â Â Â Â Â li.style.margin = '4px 0';
Â Â Â Â Â Â Â Â li.style.background = '#e9fce6';
Â Â Â Â Â Â Â Â li.style.borderRadius = '5px';
Â Â Â Â Â Â Â Â li.style.cursor = 'grab';
Â Â Â Â Â Â Â Â sortList.appendChild(li);
Â Â Â Â }
});
Â Â Â Â // ä¿®æ­£ï¼šæ¯æ¬¡é–‹å•Ÿå‰å…ˆ destroy ä¸Šä¸€æ¬¡çš„ sortable å¯¦ä¾‹ï¼Œé¿å…è§¸æ§ç„¡æ•ˆ
Â Â Â Â if (currentSortable) {
Â Â Â Â Â Â Â Â currentSortable.destroy();
Â Â Â Â Â Â Â Â currentSortable = null;
Â Â Â Â }
Â Â Â Â currentSortable = Sortable.create(sortList, {
Â Â Â Â Â Â Â Â animation: 150,
Â Â Â Â Â Â Â Â touchStartThreshold: 14 // (å¯é¸) æé«˜å®¹éŒ¯è®“æ‰‹æ©Ÿæ›´æ˜“è§¸ç™¼æ‹–æ›³
Â Â Â Â });
Â Â Â Â document.getElementById('sortModal').style.display = 'flex';
}
// æ’åº Modal é—œé–‰
function closeSortModal() {
Â Â document.body.style.overflow = '';
Â Â Â Â if (currentSortable) {
Â Â Â Â Â Â Â Â currentSortable.destroy();
Â Â Â Â Â Â Â Â currentSortable = null;
Â Â Â Â }
Â Â Â Â document.getElementById('sortModal').style.display = 'none';
}
// æ’åºçµæœå„²å­˜
function saveSortOrder() {
Â Â Â Â const sortList = document.getElementById('sortList');
Â Â Â Â const sortedNames = Array.from(sortList.children).map(li => li.textContent);
Â Â Â Â localStorage.setItem('memoryOrder', JSON.stringify(sortedNames));
Â Â Â Â closeSortModal();
Â Â Â Â updateMemorySelect();
}
// æ›´æ–°ä¸‹æ‹‰é¸å–®ä½¿ç”¨æ’åº
function updateMemorySelect() {
Â Â Â Â const selects = [document.getElementById('memorySelect'), document.getElementById('topMemorySelect')];
Â Â Â Â let memoryOrder = [];
Â Â Â Â try {
Â Â Â Â Â Â Â Â memoryOrder = JSON.parse(localStorage.getItem('memoryOrder'));
Â Â Â Â } catch(e) {
Â Â Â Â Â Â Â Â memoryOrder = null;
Â Â Â Â }
Â Â Â Â if (!Array.isArray(memoryOrder) || memoryOrder.length === 0) {
Â Â Â Â Â Â Â Â memoryOrder = Object.keys(memoryData);
Â Â Â Â }
Â Â Â Â selects.forEach(select => {
Â Â Â Â Â Â Â Â select.innerHTML = '<option value="">-- è«‹é¸æ“‡ --</option>';
Â Â Â Â Â Â Â Â memoryOrder.forEach(name => {
Â Â Â Â Â Â Â Â Â Â Â Â if (memoryData[name]) {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const option = document.createElement('option');
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â option.value = name;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â option.textContent = name;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (name === currentListName) option.selected = true;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â select.appendChild(option);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â });
Â Â Â Â });
}
function revealIntroText() {
Â Â Â Â if (window._resultShown) return; // è‹¥å·²é¡¯ç¤ºçµæœï¼Œä¸é‡æ’­å‹•ç•«
Â Â Â Â if (window._introTextAnimating) return; // é˜²æ­¢é‡è¤‡è§¸ç™¼
Â Â Â Â const resultCard = document.getElementById('resultCard');
Â Â Â Â const text = resultCard.textContent.trim();
Â Â Â Â if (text === 'å…ˆé¸æ“‡æ¸…å–®' || text.startsWith('ä¾†æ±ºå®šã€Œ')) {
Â Â Â Â Â Â Â Â // âš ï¸ å¦‚æœæ˜¯æç¤ºæ–‡å­—ï¼Œç›´æ¥é¡¯ç¤ºä¸¦ä¿æŒï¼Œä¸åŸ·è¡Œå‹•ç•«é‡ç½®
Â Â Â Â Â Â Â Â resultCard.style.opacity = 1;
Â Â Â Â Â Â Â Â resultCard.style.transform = 'scale(1)';
Â Â Â Â Â Â Â Â resultCard.classList.add('show'); // ä¿è­‰å¯è¦‹
Â Â Â Â Â Â Â Â return;
Â Â Â Â }
Â Â Â Â window._introTextAnimating = true;
Â Â Â Â resultCard.classList.remove('drop-in', 'refresh-fade-scale', 'glow', 'show');
Â Â Â Â requestAnimationFrame(() => {
Â Â Â Â Â Â Â Â requestAnimationFrame(() => {
Â Â Â Â Â Â Â Â Â Â Â Â resultCard.classList.add('show', 'glow', 'drop-in');
Â Â Â Â Â Â Â Â Â Â Â Â setTimeout(() => { window._introTextAnimating = false; }, 800);
Â Â Â Â Â Â Â Â });
Â Â Â Â });
}

function openExportImportModal() {
Â Â document.getElementById('exportImportModal').style.display = 'flex';
Â Â document.body.style.overflow = 'hidden';
}
function closeExportImportModal() {
Â Â document.getElementById('exportImportModal').style.display = 'none';
Â Â document.body.style.overflow = '';
}

function singleExport() {
Â Â shareList(); // ä½¿ç”¨åŸæœ‰æ–‡å­—åŒ¯å‡º
}

function singleImport() {
Â Â importList(); // ä½¿ç”¨åŸæœ‰æ–‡å­—åŒ¯å…¥
}

async function multiExport() {
Â Â const names = Object.keys(memoryData);
Â Â if (names.length === 0) return alert('âš ï¸ æ²’æœ‰å¯åŒ¯å‡ºçš„æ¸…å–®');
Â Â const dataStr = JSON.stringify(memoryData, null, 2);
Â Â const blob = new Blob([dataStr], { type: 'application/json' });
Â Â const file = new File([blob], 'ChooseHelper_Lists.json', { type: 'application/json' });

Â Â try {
Â Â Â Â if (navigator.canShare && navigator.canShare({ files: [file] })) {
Â Â Â Â Â Â await navigator.share({
Â Â Â Â Â Â Â Â title: 'æˆ‘çš„é¸æ“‡å°å¹«æ‰‹æ¸…å–®',
Â Â Â Â Â Â Â Â files: [file]
Â Â Â Â Â Â });
Â Â Â Â } else if (navigator.share) {
Â Â Â Â Â Â await navigator.share({
Â Â Â Â Â Â Â Â title: 'æˆ‘çš„é¸æ“‡å°å¹«æ‰‹æ¸…å–®',
Â Â Â Â Â Â Â Â text: dataStr
Â Â Â Â Â Â });
Â Â Â Â } else {
Â Â Â Â Â Â throw new Error('ä¸æ”¯æ´åˆ†äº«');
Â Â Â Â }
Â Â } catch (e) {
Â Â Â Â const url = URL.createObjectURL(blob);
Â Â Â Â const a = document.createElement('a');
Â Â Â Â a.href = url;
Â Â Â Â a.download = 'ChooseHelper_Lists.json';
Â Â Â Â document.body.appendChild(a);
Â Â Â Â a.click();
Â Â Â Â document.body.removeChild(a);
Â Â Â Â URL.revokeObjectURL(url);
Â Â }
}

function multiImport() {
Â Â const input = document.createElement('input');
Â Â input.type = 'file';
Â Â input.accept = 'application/json';
Â Â input.onchange = e => {
Â Â Â Â const file = e.target.files[0];
Â Â Â Â if (!file) return;
Â Â Â Â const reader = new FileReader();
Â Â Â Â reader.onload = ev => {
Â Â Â Â Â Â try {
Â Â Â Â Â Â Â Â const importedData = JSON.parse(ev.target.result);
Â Â Â Â Â Â Â Â if (typeof importedData !== 'object' || Array.isArray(importedData)) throw new Error();
Â Â Â Â Â Â Â Â const keys = Object.keys(importedData);
Â Â Â Â Â Â Â Â if (keys.length === 0) return alert('âŒ åŒ¯å…¥æª”æ¡ˆå…§æ²’æœ‰ä»»ä½•æ¸…å–®');
Â Â Â Â Â Â Â Â const selections = confirm(`å°‡åŒ¯å…¥ä»¥ä¸‹ ${keys.length} ç­†æ¸…å–®ï¼š\n${keys.join(', ')}\n\nç¢ºå®šåŒ¯å…¥ï¼Ÿ`);
Â Â Â Â Â Â Â Â if (selections) {
Â Â Â Â Â Â Â Â Â Â keys.forEach(name => {
Â Â Â Â Â Â Â Â Â Â Â Â if (Array.isArray(importedData[name])) {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â memoryData[name] = importedData[name];
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â Â Â Â saveMemoryData();
Â Â Â Â Â Â Â Â Â Â updateMemorySelect();
Â Â Â Â Â Â Â Â Â Â alert(`âœ… å·²åŒ¯å…¥ ${keys.length} ç­†æ¸…å–®`);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â } catch {
Â Â Â Â Â Â Â Â alert('âŒ åŒ¯å…¥å¤±æ•—ï¼šæª”æ¡ˆæ ¼å¼éŒ¯èª¤');
Â Â Â Â Â Â }
Â Â Â Â };
Â Â Â Â reader.readAsText(file);
Â Â };
Â Â input.click();
}
</script>
Â Â <div class="footer-note">Designed by KJ&nbsp;&nbsp;</div>
<div id="sortModal" style="
Â Â Â Â display: flex;
Â Â Â Â align-items: center;
Â Â Â Â justify-content: center;
Â Â Â Â flex-direction: column;
Â Â Â Â position: fixed;
Â Â Â Â top: 0;
Â Â Â Â left: 0;
Â Â Â Â width: 100%;
Â Â Â Â height: 100%;
Â Â Â Â background: rgba(0,0,0,0.5);
Â Â Â Â z-index: 9999;
Â Â Â Â display: none; /* é è¨­éš±è—ï¼Œæ‰“é–‹æ™‚è¨­ç‚º flex */
">
Â Â <div style="
Â Â Â Â background: #fff;
Â Â Â Â padding: 16px;
Â Â Â Â border-radius: 8px;
Â Â Â Â max-width: 320px;
Â Â Â Â width: 85%;
Â Â Â Â max-height: 65vh; Â  Â  Â  Â  Â  Â  Â  Â  /* âœ… ä¿®æ­£ h â†’ vh */
Â Â Â Â overflow-y: auto; Â  Â  Â  Â  Â  Â  Â  Â  /* âœ… å¯æ»‘å‹• */
Â Â Â Â touch-action: pan-y;Â  Â  Â  Â  Â  Â  Â  /* âœ… ç©ºç™½è™•å¯æ»‘å‹• */
Â Â Â Â -webkit-overflow-scrolling: touch; /* âœ… iOS æ…£æ€§æ»‘å‹• */
">
Â Â Â Â <h3>æ‹–æ›³æ’åºæ¸…å–®</h3>
Â Â Â Â <ul id="sortList" style="list-style: none; padding: 0; max-height: 300px; overflow: auto;"></ul>
Â Â Â Â <button class="btn-primary" onclick="saveSortOrder()">å„²å­˜é †åº</button>
Â Â Â Â <button class="btn-pink" onclick="closeSortModal()">é—œé–‰</button>
Â Â </div>
</div>

<div id="exportImportModal" style="
Â Â display: none;
Â Â position: fixed;
Â Â top: 0; left: 0;
Â Â width: 100%; height: 100%;
Â Â background: rgba(0,0,0,0.5);
Â Â z-index: 9999;
Â Â align-items: center;
Â Â justify-content: center;
">
Â Â <div style="
Â Â Â Â background: #fff;
Â Â Â Â padding: 20px;
Â Â Â Â border-radius: 10px;
Â Â Â Â max-width: 340px;
Â Â Â Â width: 85%;
Â Â Â Â text-align: center;
Â Â Â Â display: flex;
Â Â Â Â flex-direction: column;
Â Â Â Â gap: 12px;
Â Â ">
Â Â Â Â <h3>è«‹é¸æ“‡åŒ¯å‡º / åŒ¯å…¥æ–¹å¼</h3>
Â Â Â Â <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
Â Â Â Â Â Â <button class="btn-lightblue" style="flex: 1;" onclick="singleExport()">å–®ç­†åŒ¯å‡º</button>
Â Â Â Â Â Â <button class="btn-lightblue" style="flex: 1;" onclick="multiExport()">å¤šç­†åŒ¯å‡º</button>
Â Â Â Â </div>
Â Â Â Â <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
Â Â Â Â Â Â <button style="flex: 1; background-color: #e9fce6; color: #333; border: none; border-radius: 5px; padding: 10px 16px; font-size: 14px; cursor: pointer;" onclick="singleImport()">å–®ç­†åŒ¯å…¥</button>
Â Â Â Â Â Â <button style="flex: 1; background-color: #e9fce6; color: #333; border: none; border-radius: 5px; padding: 10px 16px; font-size: 14px; cursor: pointer;" onclick="multiImport()">å¤šç­†åŒ¯å…¥</button>
Â Â Â Â </div>
Â Â Â Â <button class="btn-pink" style="margin-top: 10px;" onclick="closeExportImportModal()">é—œé–‰</button>
Â Â </div>
</div>
</body>
</html>