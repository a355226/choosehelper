<!DOCTYPE html>
<html lang="zh-Hant">
<head>
Â Â <!-- åˆ†é ç”¨ -->
<link rel="icon" type="image/png" sizes="32x32" href="icon.png">

<!-- iOS ä¸»ç•«é¢ç”¨ -->
<link rel="apple-touch-icon" sizes="180x180" href="icon.png">

<!-- Android PWA -->
<link rel="manifest" href="manifest.json">
Â Â <meta charset="UTF-8">
Â Â <title>é¸æ“‡å°å¹«æ‰‹</title>
Â Â <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
Â Â <style>
Â Â Â Â body {
Â Â Â Â Â Â font-family: "Segoe UI", sans-serif;
Â Â Â Â Â Â background-color: #f0f9ff;
Â Â Â Â Â Â margin: 0;
Â Â Â Â Â Â padding: 0;
Â Â Â Â }
Â Â Â Â .nav {
Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â justify-content: center;
Â Â Â Â Â Â background-color: #a8dadc;
Â Â Â Â Â Â padding: 10px 0;
Â Â Â Â Â Â flex-wrap: wrap;
Â Â Â Â }
Â Â Â Â .nav button {
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â padding: 10px 20px;
Â Â Â Â Â Â margin: 6px;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â background-color: #ffffff;
Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â box-shadow: 0 2px 6px rgba(0,0,0,0.15);
Â Â Â Â Â Â transition: all 0.2s ease;
Â Â Â Â }
Â Â Â Â .nav button.active {
Â Â Â Â Â Â background-color: #ffe066;
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â transform: scale(1.05);
Â Â Â Â }
Â Â Â Â .page {
Â Â Â Â Â Â display: none;
Â Â Â Â Â Â padding: 20px;
Â Â Â Â Â Â max-width: 600px;
Â Â Â Â Â Â margin: auto;
Â Â Â Â }
Â Â Â Â .page.active {
Â Â Â Â Â Â display: block;
Â Â Â Â }
Â Â Â Â h1 {
Â Â Â Â Â Â text-align: center;
Â Â Â Â Â Â padding: 20px;
Â Â Â Â Â Â color: #2c3e50;
Â Â Â Â Â Â margin: 0;
Â Â Â Â }
Â Â Â Â .btn-primary {
Â Â Â Â Â Â background-color: #3db8c4;
Â Â Â Â Â Â color: white;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â border-radius: 8px;
Â Â Â Â Â Â padding: 12px 20px;
Â Â Â Â Â Â font-size: 18px;
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â box-shadow: 0 4px 6px rgba(0,0,0,0.1);
Â Â Â Â Â Â transition: all 0.2s ease;
Â Â Â Â }
Â Â Â Â .btn-primary:hover {
Â Â Â Â Â Â background-color: #35a4af;
Â Â Â Â Â Â box-shadow: 0 6px 12px rgba(0,0,0,0.15);
Â Â Â Â Â Â transform: translateY(-2px);
Â Â Â Â }
Â Â Â Â .btn-primary:active {
Â Â Â Â Â Â background-color: #2d8e98;
Â Â Â Â Â Â box-shadow: 0 2px 4px rgba(0,0,0,0.2) inset;
Â Â Â Â Â Â transform: translateY(1px);
Â Â Â Â }
Â Â Â Â .btn-yellow {
Â Â Â Â Â Â background-color: #fff3b0;
Â Â Â Â Â Â color: #333;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â border-radius: 8px;
Â Â Â Â Â Â padding: 10px 14px;
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â margin: 4px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â }
Â Â Â Â input, select, button {
Â Â Â Â Â Â padding: 10px;
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â margin: 6px 4px 10px 0;
Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â border: 1px solid #ccc;
Â Â Â Â Â Â box-sizing: border-box;
Â Â Â Â }
Â Â Â Â input, select {
Â Â Â Â Â Â width: 100%;
Â Â Â Â }
Â Â Â Â ul {
Â Â Â Â Â Â list-style-type: none;
Â Â Â Â Â Â padding: 0;
Â Â Â Â }
Â Â Â Â li {
Â Â Â Â Â Â background: #e9fce6;
Â Â Â Â Â Â padding: 10px;
Â Â Â Â Â Â margin-bottom: 8px;
Â Â Â Â Â Â border-radius: 6px;
Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â justify-content: space-between;
Â Â Â Â Â Â align-items: center;
Â Â Â Â }
Â Â Â Â li span {
Â Â Â Â Â Â flex-grow: 1;
Â Â Â Â Â Â min-width: 0;
Â Â Â Â Â Â white-space: nowrap;
Â Â Â Â Â Â overflow: hidden;
Â Â Â Â Â Â text-overflow: ellipsis;
Â Â Â Â }
Â Â Â Â .remove-btn {
Â Â Â Â Â Â background: none;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â color: #c0392b;
Â Â Â Â Â Â font-size: 18px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â margin-left: 10px;
Â Â Â Â Â Â flex-shrink: 0;
Â Â Â Â }
.random-container {
  text-align: center;
  margin-top: 20px;
  min-height: 260px; /* âœ… æ ¹æ“š slot + result å…§å®¹èª¿æ•´ï¼Œé«˜åº¦ç©©å®šä¸è·³å‹• */
}
Â Â Â Â .result-card {
Â Â Â Â Â Â margin-top: 30px;
Â Â Â Â Â Â padding: 30px;
Â Â Â Â Â Â background: linear-gradient(145deg, #fff8dc, #fff6ae);
Â Â Â Â Â Â border-radius: 20px;
Â Â Â Â Â Â box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
Â Â Â Â Â Â font-size: 2.2em;
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â color: #b34400;
Â Â Â Â Â Â opacity: 0;
Â Â Â Â Â Â transform: scale(0.5);
Â Â Â Â Â Â transition: all 0.6s ease;
Â Â Â Â Â Â Â Â white-space: nowrap; Â  Â  Â  Â  Â  Â  /* ä¸æ›è¡Œ */
Â Â overflow: hidden;Â  Â  Â  Â  Â  Â  Â  Â  /* è¶…å‡ºéš±è— */
Â Â text-overflow: ellipsis;Â  Â  Â  Â  /* åŠ ä¸Šçœç•¥è™Ÿï¼ˆå¯é¸ï¼‰ */
Â Â font-size: clamp(1.5em, 7vw, 3em); /* è‡ªå‹•ç¸®æ”¾æ–‡å­—å¤§å°ï¼Œé¿å…æ›è¡Œ */
Â Â Â Â }
Â Â Â Â .result-card.show {
Â Â Â Â Â Â opacity: 1;
Â Â Â Â Â Â transform: scale(1);
Â Â Â Â }
Â Â Â Â .result-card.glow {
Â Â Â Â Â Â animation: multiGlow 1.8s ease-out;
Â Â Â Â Â Â animation-fill-mode: both;
Â Â Â Â }
Â Â Â Â @keyframes fadeOutShrink {
Â Â 0% {
Â Â Â Â opacity: 1;
Â Â Â Â transform: scale(1);
Â Â }
Â Â 100% {
Â Â Â Â opacity: 0;
Â Â Â Â transform: scale(0.6);
Â Â }
}

.result-card.fade-out {
Â Â animation: fadeOutShrink 0.4s ease forwards;
}
Â Â Â Â @keyframes multiGlow {
Â Â Â Â Â Â 0% Â  { box-shadow: 0 0 0 transparent; }
Â Â Â Â Â Â 20%Â  { box-shadow: 0 0 20px #ffd700; }
Â Â Â Â Â Â 40%Â  { box-shadow: 0 0 25px #ffffff; }
Â Â Â Â Â Â 60%Â  { box-shadow: 0 0 30px #ff8c00; }
Â Â Â Â Â Â 80%Â  { box-shadow: 0 0 25px #ffe066; }
Â Â Â Â Â Â 100% { box-shadow: 0 0 20px #ffd700; }
Â Â Â Â }
Â Â Â Â .current-list-label {
Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â margin-bottom: 10px;
Â Â Â Â Â Â color: #333;
Â Â Â Â }
Â Â Â Â .current-list-label select {
Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â color: #2c3e50;
Â Â Â Â Â Â background-color: #fff;
Â Â Â Â Â Â border: 1px solid #aaa;
Â Â Â Â }

Â Â Â Â .btn-pink {
Â Â Â Â Â Â background-color: #fcebeb;
Â Â Â Â Â Â color: #333;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â padding: 10px 16px;
Â Â Â Â Â Â font-size: 14px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â }

Â Â Â Â .btn-lightblue {
Â Â Â Â Â Â background-color: #e0f4ff;
Â Â Â Â Â Â color: #333;
Â Â Â Â Â Â border: none;
Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â padding: 10px 16px;
Â Â Â Â Â Â font-size: 14px;
Â Â Â Â Â Â cursor: pointer;
Â Â Â Â }
.slot-machine {
  height: 60px;        /* âœ… ä¿ç•™ */
  visibility: hidden;  /* âœ… å–ä»£ display: noneï¼Œä¸ç ´å£ç‰ˆé¢ */
  opacity: 0;
Â Â overflow: hidden;
Â Â position: relative;
Â Â margin: 30px auto 0;
Â Â width: 80%;
Â Â max-width: 300px;
Â Â background: white;
Â Â border-radius: 12px;
Â Â box-shadow: 0 4px 12px rgba(0,0,0,0.2);
Â Â font-size: 26px;
Â Â font-weight: bold;
Â Â text-align: center;
Â Â color: #b34400;
Â Â border: 3px dashed #ffe066;
Â Â transition: all 0.4s ease;
}

.slot-machine.show {
Â Â visibility: visible;
Â Â opacity: 1;
}

.slot-content {
Â Â display: flex;
Â Â flex-direction: column;
Â Â animation: spinScroll 3.2s ease-out forwards;
}

@keyframes spinScroll {
Â Â 0% Â  { transform: translateY(0); }
Â Â 100% { transform: translateY(-100%); }
}
.current-list-label {
Â Â width: 100%;
Â Â margin: 10px 0;
}

.label-left {
Â Â text-align: left;
Â Â font-size: 1.2em;
Â Â margin-bottom: 4px;
Â Â padding-left: 12px;
}

.select-center {
Â Â display: flex;
Â Â justify-content: center;
Â Â width: 100%;
}

.select-center select {
Â Â min-width: 160px;
Â Â max-width: 80vw;
Â Â font-size: 1em;
Â Â text-align: center; Â  Â  Â  /* â† æ§åˆ¶é–‹å•Ÿä¸‹æ‹‰é¸å–®æ™‚çš„é¸é …ç½®ä¸­ */
Â Â text-align-last: center;Â  /* â† æ§åˆ¶å·²é¸æ–‡å­—åœ¨æ¡†ä¸­ç½®ä¸­ */
}
#effectSelect {
Â Â appearance: none; /* âœ… ç§»é™¤ç³»çµ±æ¨£å¼ */
Â Â font-size: 16px;
Â Â padding: 8px 16px;
Â Â color:#3C3C3C;
Â Â border-radius: 8px;
Â Â border: 2px solid #ffd700;
Â Â background-color: #f7f7e1;
Â Â font-weight: bold;
Â Â width: auto;
Â Â text-align-last: center;
Â Â box-shadow: 0 2px 5px rgba(0,0,0,0.1);
Â Â cursor: pointer;
}

.video-wrapper {
Â Â width: 100%;
Â Â max-width: 420px;
Â Â margin: 30px auto 20px auto;
Â Â position: relative;
Â Â overflow: hidden;
Â Â border-radius: 20px;
Â Â box-shadow: 0 0 20px rgba(255, 223, 0, 0.4);
Â Â pointer-events: none;
Â Â max-height: 240px;Â  Â  Â  Â  Â  /* âœ… é™åˆ¶æœ€å¤§é«˜åº¦ */
Â Â min-height: 200px; Â  Â  Â  /* âœ… é ç•™é«˜åº¦é¿å…ç•«é¢çªç„¶æ’é–‹ */
Â Â opacity: 0;Â  Â  Â  Â  Â  Â  Â  /* âœ… ä¸€é–‹å§‹éš±è— */
Â Â transition: opacity 0.3s ease;
}
.video-wrapper.show {
Â Â opacity: 1;Â  Â  Â  Â  Â  Â  Â  /* âœ… å‡ºç¾æ™‚æ·¡å…¥ */
}

.custom-video {
Â Â width: 100%;
Â Â height: 100%;
Â Â object-fit: cover;
Â Â border-radius: 20px;
Â Â mask-image: radial-gradient(circle at center, rgba(0,0,0,1) 60%, rgba(0,0,0,0) 100%);
Â Â mask-composite: exclude;
}

.video-wrapper.glow-out {
Â Â animation: glowOut 1s ease forwards;
}

@keyframes glowOut {
Â Â 0% {
Â Â Â Â box-shadow: 0 0 20px rgba(255, 200, 0, 0.6);
Â Â Â Â opacity: 1;
Â Â Â Â transform: scale(1);
Â Â }
Â Â 100% {
Â Â Â Â box-shadow: 0 0 80px rgba(255, 255, 0, 0.2);
Â Â Â Â opacity: 0;
Â Â Â Â transform: scale(1.4);
Â Â Â Â margin-bottom: -200px; /* â† å¼·åˆ¶å£“ç¸®ç©ºé–“ */
Â Â Â Â visibility: hidden;
Â Â }
}

@keyframes fadeIn {
Â Â from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
Â Â to Â  { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}
.result-card.transitioning {
Â Â opacity: 0;
Â Â transform: scale(0.9);
}

.result-card.reveal {
Â Â transition: all 0.6s ease;
Â Â opacity: 1;
Â Â transform: scale(1);
}
.btn-primary.disabled {
Â Â background-color: #ddd !important;
Â Â color: #999 !important;
Â Â cursor: not-allowed !important;
Â Â box-shadow: none !important;
Â Â transform: none !important;
}
Â Â </style>
</head>
<body>
<h1><img src="https://cdn.jsdelivr.net/gh/a355226/choosehelper@main/icon.png" alt="icon" width="32">
é¸æ“‡å°å¹«æ‰‹</h1>

<div class="nav">
Â Â <button class="active" onclick="showPage('randomPage')">ğŸ”€ éš¨æ©Ÿé¸æ“‡</button>
Â Â <button onclick="showPage('editPage')">ğŸ“ ç·¨è¼¯æ¸…å–®</button>
</div>

<div class="page active" id="randomPage">
Â Â <div class="current-list-label">
Â Â <div class="label-left">ç›®å‰æ¸…å–®ï¼š</div>
Â Â <div class="select-center">
Â Â Â Â <select id="topMemorySelect" onchange="switchMemoryFromTop()">
Â Â Â Â Â Â <option value="">-- è«‹é¸æ“‡ --</option>
Â Â Â Â </select>
Â Â </div>
Â Â </div>
Â Â <div class="random-container">
Â Â Â Â <button class="btn-primary" style="width:100%; font-size:20px;" onclick="chooseRandom()">ğŸ² éš¨æ©Ÿé¸ ğŸ²</button>
Â Â Â Â <div id="resultCard" class="result-card">è«‹å…ˆå»ºç«‹æ¸…å–®</div>
<div id="slotMachine" class="slot-machine"></div>
Â Â Â Â <div id="appealArea"></div>
Â Â </div>
</div>

Â Â <div id="effectSelectorContainer" style="margin-top: 40px; text-align: center;">
Â Â <label for="effectSelect" style="font-weight: bold;">ğŸ¬ï¼š</label>
Â Â <select id="effectSelect" onchange="handleEffectChange()">
Â Â Â Â <option value="default">é è¨­</option>
Â Â Â Â <option value="video001">ææ€–è²å­</option>
Â Â Â Â <!-- å¯æŒçºŒæ–°å¢ï¼š<option value="video002">çˆ†ç‚¸ç‰¹æ•ˆ</option> ç­‰ç­‰ -->
Â Â </select>
</div>


<div class="page" id="editPage">
Â Â <div class="section-title">ğŸ“‚ åˆ‡æ›æ¸…å–®ï¼š</div>
Â Â <select id="memorySelect" onchange="loadMemoryList()">
Â Â Â Â <option value="">-- è«‹é¸æ“‡ --</option>
Â Â </select>
Â Â <button class="btn-pink" onclick="deleteMemoryList()">ğŸ—‘ åˆªé™¤æ¸…å–®</button>

Â Â <div class="section-title">ğŸ–Š è¼¸å…¥é …ç›®ï¼š</div>
Â Â <input type="text" id="foodInput" placeholder="è«‹è¼¸å…¥" />
Â Â <button class="btn-primary" onclick="addFood()">åŠ å…¥</button>
Â Â <button class="btn-lightblue" onclick="saveCurrentList()">å»ºç«‹</button>
Â Â <button class="btn-lightblue" onclick="updateCurrentList()">æ›´æ–°</button>
Â Â <button class="btn-pink"Â  onclick="clearAllItems()">å…¨éƒ¨æ¸…é™¤</button>
Â Â <div class="section-title">ğŸ“ƒ ç›®å‰æ¸…å–®ï¼š</div>
Â Â <ul id="foodList"></ul>
Â Â <div style="margin-top: 70px;">
Â Â Â Â <button class="btn-lightblue" onclick="shareList()">åŒ¯å‡º</button>
Â Â Â Â <button class="btn-lightblue" onclick="importList()">åŒ¯å…¥</button>
Â Â </div>
</div>

<script>
let currentList = [];
let memoryData = JSON.parse(localStorage.getItem('memoryData')) || {};
let currentListName = "";

function showPage(id) {
Â Â document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
Â Â document.getElementById(id).classList.add('active');
Â Â document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
Â Â const btn = id === 'randomPage' ? document.querySelectorAll('.nav button')[0] : document.querySelectorAll('.nav button')[1];
Â Â btn.classList.add('active');

Â Â // ğŸ”» å¦‚æœæ˜¯åˆ‡æ›åˆ° randomPageï¼Œå°±é‡è¨­ slotMachine ç‹€æ…‹
Â Â if (id === 'randomPage') {
Â Â Â Â const slotMachine = document.getElementById('slotMachine');
Â Â Â Â const resultCard = document.getElementById('resultCard');
Â Â Â Â const appealArea = document.getElementById('appealArea');
Â Â Â Â slotMachine.innerHTML = '';
Â Â Â Â slotMachine.classList.remove('show');
Â Â Â Â resultCard.textContent = 'è«‹å…ˆå»ºç«‹æ¸…å–®';
Â Â Â Â resultCard.classList.remove('glow', 'show');
Â Â Â Â appealArea.innerHTML = '';
Â Â Â Â enableRandomButton(); // âœ… æ¯æ¬¡åˆ‡åˆ° randomPage å°±é‡å•ŸæŒ‰éˆ•
Â Â }

Â Â // ğŸ”» åŠ é€™æ®µï¼šåˆ‡æ›é é¢æ™‚åˆ‡æ›ç‰¹æ•ˆé¸å–®é¡¯ç¤º
Â Â const effectContainer = document.getElementById('effectSelectorContainer');
Â Â effectContainer.style.display = (id === 'randomPage') ? 'block' : 'none';
}


function saveMemoryData() {
Â Â localStorage.setItem('memoryData', JSON.stringify(memoryData));
}

function addFood() {
Â Â const input = document.getElementById('foodInput');
Â Â const food = input.value.trim();
Â Â if (food) {
Â Â Â Â currentList.push(food);
Â Â Â Â input.value = '';
Â Â Â Â renderCurrentList();
Â Â }
}

function renderCurrentList() {
Â Â const ul = document.getElementById('foodList');
Â Â ul.innerHTML = '';
Â Â currentList.forEach((item, index) => {
Â Â Â Â const li = document.createElement('li');
Â Â Â Â const span = document.createElement('span');
Â Â Â Â span.textContent = item;
Â Â Â Â const btn = document.createElement('button');
Â Â Â Â btn.textContent = 'âœ•';
Â Â Â Â btn.className = 'remove-btn';
Â Â Â Â btn.onclick = () => removeItem(index);
Â Â Â Â li.appendChild(span);
Â Â Â Â li.appendChild(btn);
Â Â Â Â ul.appendChild(li);
Â Â });
}
function removeItem(index) {
Â Â currentList.splice(index, 1);
Â Â renderCurrentList();
}

function clearAllItems() {
Â Â if (confirm("ç¢ºå®šè¦æ¸…é™¤ç›®å‰æ‰€æœ‰é …ç›®ï¼Ÿ")) {
Â Â Â Â currentList = [];
Â Â Â Â renderCurrentList();
Â Â }
}

function saveCurrentList() {
Â Â const name = prompt("è«‹è¼¸å…¥æ­¤æ¸…å–®çš„åç¨±ï¼š");
Â Â if (name && name.trim()) {
Â Â Â Â memoryData[name] = [...currentList];
Â Â Â Â currentListName = name;
Â Â Â Â saveMemoryData();
Â Â Â Â updateMemorySelect();
Â Â Â Â alert(`å·²è¨˜æ†¶æ¸…å–®ï¼šã€Œ${name}ã€`);
Â Â }
}

function updateMemorySelect() {
Â Â const selects = [document.getElementById('memorySelect'), document.getElementById('topMemorySelect')];
Â Â selects.forEach(select => {
Â Â Â Â select.innerHTML = '<option value="">-- è«‹é¸æ“‡ --</option>';
Â Â Â Â for (let name in memoryData) {
Â Â Â Â Â Â const option = document.createElement('option');
Â Â Â Â Â Â option.value = name;
Â Â Â Â Â Â option.textContent = name;
Â Â Â Â Â Â if (name === currentListName) option.selected = true;
Â Â Â Â Â Â select.appendChild(option);
Â Â Â Â }
Â Â });
}

function loadMemoryList() {
Â Â const selected = document.getElementById('memorySelect').value;
Â Â if (!selected) {
Â Â Â Â currentList = [];
Â Â Â Â currentListName = "";
Â Â Â Â renderCurrentList();
Â Â Â Â return;
Â Â }

Â Â if (memoryData[selected]) {
Â Â Â Â currentList = [...memoryData[selected]];
Â Â Â Â currentListName = selected;
Â Â Â Â updateMemorySelect();
Â Â Â Â renderCurrentList();
Â Â }
}

function switchMemoryFromTop() {
Â Â const selected = document.getElementById('topMemorySelect').value;
Â Â if (!selected) {
Â Â Â Â currentList = [];
Â Â Â Â currentListName = "";
Â Â Â Â renderCurrentList();
Â Â Â Â return;
Â Â }
Â Â if (memoryData[selected]) {
Â Â Â Â currentList = [...memoryData[selected]];
Â Â Â Â currentListName = selected;
Â Â Â Â updateMemorySelect();
Â Â Â Â renderCurrentList();
Â Â }
}

function deleteMemoryList() {
Â Â const selected = document.getElementById('memorySelect').value;
Â Â if (selected && memoryData[selected]) {
Â Â Â Â if (confirm(`ç¢ºå®šè¦åˆªé™¤è¨˜æ†¶æ¸…å–®ï¼šã€Œ${selected}ã€ï¼Ÿ`)) {
Â Â Â Â Â Â delete memoryData[selected];
Â Â Â Â Â Â if (currentListName === selected) {
Â Â Â Â Â Â Â Â currentListName = "";
Â Â Â Â Â Â Â Â currentList = [];
Â Â Â Â Â Â Â Â renderCurrentList();
Â Â Â Â Â Â }
Â Â Â Â Â Â saveMemoryData();
Â Â Â Â Â Â updateMemorySelect();
Â Â Â Â Â Â alert(`ã€Œ${selected}ã€å·²åˆªé™¤`);
Â Â Â Â }
Â Â } else {
Â Â Â Â alert("è«‹å…ˆé¸æ“‡è¦åˆªé™¤çš„æ¸…å–®");
Â Â }
}

function shareList() {
Â Â const text = JSON.stringify({ name: currentListName, items: currentList });
Â Â if (navigator.share) {
Â Â Â Â navigator.share({
Â Â Â Â Â Â title: 'æˆ‘çš„é¸æ“‡æ¸…å–®',
Â Â Â Â Â Â text: text
Â Â Â Â }).catch(err => alert("åˆ†äº«å¤±æ•—ï¼š" + err));
Â Â } else {
Â Â Â Â prompt("è«‹è¤‡è£½ä»¥ä¸‹å…§å®¹ä»¥åˆ†äº«ï¼š", text);
Â Â }
}

function importList() {
Â Â const text = prompt("è«‹è²¼ä¸Šåˆ†äº«å…§å®¹ï¼š");
Â Â if (!text) return;
Â Â try {
Â Â Â Â const parsed = JSON.parse(text);
Â Â Â Â if (!parsed.name || !Array.isArray(parsed.items)) throw new Error("æ ¼å¼éŒ¯èª¤");
Â Â Â Â memoryData[parsed.name] = parsed.items;
Â Â Â Â currentListName = parsed.name;
Â Â Â Â currentList = [...parsed.items];
Â Â Â Â saveMemoryData();
Â Â Â Â updateMemorySelect();
Â Â Â Â renderCurrentList();
Â Â Â Â alert(`æˆåŠŸåŒ¯å…¥æ¸…å–®ï¼šã€Œ${parsed.name}ã€`);
Â Â } catch (e) {
Â Â Â Â alert("âŒ åŒ¯å…¥å¤±æ•—ï¼šæ ¼å¼éŒ¯èª¤");
Â Â }
}

// åˆå§‹åŒ–
updateMemorySelect();
renderCurrentList();

let appealCount = 3;
let lastIndex = -1; // è¨˜éŒ„ä¸Šæ¬¡çš„çµæœä½ç½®

function secureRandomIndex(max) {
Â Â const arr = new Uint32Array(1);
Â Â window.crypto.getRandomValues(arr);
Â Â return Math.floor(arr[0] / (2**32) * max);
}

function chooseRandom(isAppeal = false) {
Â Â const randomBtn = document.querySelector('.btn-primary');
if (!isAppeal && randomBtn.classList.contains('disabled')) return;
randomBtn.classList.add('disabled'); // å¥—ç”¨ç¦ç”¨æ¨£å¼
randomBtn.disabled = true; // é˜²æ­¢é€£é»
Â Â const resultCard = document.getElementById('resultCard');
Â Â const appealArea = document.getElementById('appealArea');
Â Â const slotMachine = document.getElementById('slotMachine');
Â Â const effect = document.getElementById('effectSelect')?.value || 'default';

Â Â if (!isAppeal) appealCount = 3;
Â Â appealArea.innerHTML = '';
Â Â // å…ˆåŸ·è¡Œæ·¡å‡ºå‹•ç•«ï¼Œå†æ¸…ç©ºæ–‡å­—èˆ‡ class
document.getElementById('effectSelectorContainer').style.display = 'none';
resultCard.style.transition = 'all 0.4s ease';
resultCard.style.opacity = '0';
resultCard.style.transform = 'scale(0.6)';
setTimeout(() => {
Â Â resultCard.textContent = '';
Â Â resultCard.className = 'result-card'; // æ¸…é™¤æ‰€æœ‰ class
Â Â resultCard.style.opacity = '';
Â Â resultCard.style.transform = '';
Â Â resultCard.style.transition = '';
}, 400);
Â Â 
Â Â Â Â // ğŸ”» æ¸…é™¤ä¸Šä¸€å€‹å½±ç‰‡ï¼ˆé¿å…å¤šå€‹å½±ç‰‡æ®˜ç•™ï¼‰
Â Â const oldWrapper = document.querySelector('.video-wrapper');
Â Â if (oldWrapper) oldWrapper.remove();
Â Â 
Â Â // âœ… é‡ç½®æ‹‰éœ¸å‹•ç•«å€å¡Š
Â Â slotMachine.innerHTML = '';
Â Â slotMachine.classList.remove('show');


Â if (effect === 'video001') {
Â Â const wrapper = document.createElement('div');
wrapper.className = 'video-wrapper';
document.querySelector('.random-container').insertBefore(wrapper, resultCard);Â  // æ’å…¥ä½ç½®å…ˆæ’å¥½

const video = document.createElement('video');
video.src = "https://cdn.jsdelivr.net/gh/a355226/choosehelper@main/video001.mp4";
video.autoplay = true;
video.playsInline = true;
video.muted = true;
video.className = "custom-video";

wrapper.appendChild(video);Â  // ç¾åœ¨æ‰ append æ˜¯æ­£ç¢ºçš„
setTimeout(() => wrapper.classList.add('show'), 50);
Â Â setTimeout(() => wrapper.classList.add('show'), 50);

Â Â const randomBtn = document.querySelector('.btn-primary');
Â Â document.querySelector('.random-container').insertBefore(wrapper, resultCard);
wrapper.scrollIntoView({ behavior: 'smooth', block: 'center' });
Â Â 

Â Â // âœ… åŠ é€™æ®µï¼šæ’­æ”¾éç¨‹ä¸­å°±ä¸è¦æ’é–‹å¤ªå¤šç©ºé–“
Â Â wrapper.style.maxHeight = '240px';

video.onended = () => {
Â Â wrapper.classList.add('glow-out'); // âœ… æ’­æ”¾æ·¡å‡ºå‹•ç•«
Â Â setTimeout(() => {
Â Â Â Â wrapper.remove();

Â Â Â Â // åŠ å…¥éå ´æ•ˆæœ
Â Â Â Â resultCard.classList.remove('show', 'glow');
Â Â Â Â resultCard.classList.add('transitioning');
Â Â Â Â lastIndex = secureRandomIndex(currentList.length);
Â Â Â Â resultCard.textContent = `ğŸ‰ ${currentList[lastIndex]}`;

Â Â Â Â // æ·¡å…¥é¡¯ç¤ºçµæœ
Â Â Â Â setTimeout(() => {
Â Â Â Â Â Â resultCard.classList.remove('transitioning');
Â Â Â Â Â Â resultCard.classList.add('reveal', 'show', 'glow');
Â Â Â Â }, 100);

Â Â Â Â // å»¶é²å‡ºç¾ã€Œä¸Šè¨´ã€æˆ–ã€Œèªå‘½å§ã€æ–‡å­—
Â Â Â Â setTimeout(() => {
Â Â Â Â Â Â const appealArea = document.getElementById('appealArea');
Â Â Â Â Â Â appealArea.innerHTML = '';
Â Â Â Â Â Â if (appealCount > 0) {
Â Â Â Â Â Â Â Â const btn = document.createElement('button');
Â Â Â Â Â Â Â Â btn.textContent = `ä¸Šè¨´ï¼ï¼ˆå‰©é¤˜${appealCount}æ¬¡ï¼‰`;
Â Â Â Â Â Â Â Â btn.className = 'btn-pink';
Â Â Â Â Â Â Â Â btn.style.marginTop = '40px';
Â Â Â Â Â Â Â Â btn.style.backgroundColor = ['#ffe6e6', '#ffb3b3', '#ff6666'][3 - appealCount] || '#ff6666';
Â Â Â Â Â Â Â Â btn.style.color = '#800000';
Â Â Â Â Â Â Â Â btn.onclick = () => {
Â Â Â Â Â Â Â Â Â Â appealCount--;
Â Â Â Â Â Â Â Â Â Â chooseRandom(true);
Â Â Â Â Â Â Â Â };
Â Â Â Â Â Â Â Â appealArea.appendChild(btn);
Â Â Â Â Â Â } else {
Â Â Â Â Â Â Â Â const finalText = document.createElement('div');
Â Â Â Â Â Â Â Â finalText.textContent = 'èªå‘½å§ï¼Œé€™å°±æ˜¯æœ€å¥½çš„é¸æ“‡ï¼';
Â Â Â Â Â Â Â Â finalText.style.marginTop = '20px';
Â Â Â Â Â Â Â Â finalText.style.fontWeight = 'bold';
Â Â Â Â Â Â Â Â finalText.style.color = '#b34400';
Â Â Â Â Â Â Â Â appealArea.appendChild(finalText);
Â Â Â Â Â Â }
Â Â Â Â }, 300);
Â Â Â Â enableRandomButton(); // ğŸ‘‰ æ’­å®Œæ¢å¾©æŒ‰éˆ•
Â Â Â Â Â Â // âœ… è£œä¸Šç‰¹æ•ˆé¸å–®é‡æ–°å‡ºç¾
Â Â document.getElementById('effectSelectorContainer').style.display = 'block';
Â Â }, 300); // èˆ‡ glow-out å‹•ç•«æ™‚é–“ä¸€è‡´
};
} else {
Â Â resultCard.textContent = 'ğŸ° æ­£åœ¨æŠ½ç±¤...';
Â Â resultCard.classList.add('show');
Â Â runSlotAnimation();
}
}

function updateCurrentList() {
Â Â if (!currentListName) {
Â Â Â Â alert("âš ï¸ å°šæœªé¸æ“‡ä»»ä½•è¨˜æ†¶æ¸…å–®ï¼Œè«‹å…ˆé¸æ“‡ä¸€å€‹è¦æ›´æ–°çš„æ¸…å–®");
Â Â Â Â return;
Â Â }
Â Â memoryData[currentListName] = [...currentList];
Â Â saveMemoryData();
Â Â alert(`âœ… å·²æ›´æ–°æ¸…å–®ï¼šã€Œ${currentListName}ã€`);
Â Â updateMemorySelect(); // å¯é¸ï¼Œæœ‰æ™‚å€™æœƒåˆ·æ–°ä¸‹æ‹‰é¸å–®é¡¯ç¤ºç‹€æ…‹
}

Â function runSlotAnimation() {
Â Â const slotMachine = document.getElementById('slotMachine');
Â Â const resultCard = document.getElementById('resultCard');
Â Â const appealArea = document.getElementById('appealArea');

Â Â let finalIndex = secureRandomIndex(currentList.length);
Â Â lastIndex = finalIndex;

Â Â const spinList = [];
Â Â for (let i = 0; i < 90; i++) {
Â Â Â Â spinList.push(currentList[secureRandomIndex(currentList.length)]);
Â Â }
Â Â spinList.push(currentList[finalIndex]);

Â Â const slotContent = document.createElement('div');
Â Â slotContent.className = 'slot-content';
Â Â slotContent.style.animation = 'none';
Â Â slotContent.innerHTML = spinList.map(item => `<div>${item}</div>`).join('');
Â Â slotMachine.innerHTML = '';
Â Â slotMachine.appendChild(slotContent);

Â Â slotMachine.classList.add('show');
Â Â void slotContent.offsetWidth;
Â Â slotContent.style.animation = 'spinScroll 3.2s ease-out forwards';

Â Â setTimeout(() => {
Â Â Â Â revealResult();
Â Â }, 3300);
}
Â Â 
Â Â function revealResult() {
Â Â const resultCard = document.getElementById('resultCard');
Â Â const appealArea = document.getElementById('appealArea');

Â Â const finalIndex = lastIndex >= 0 ? lastIndex : secureRandomIndex(currentList.length);
Â Â resultCard.textContent = `ğŸ‰ ${currentList[finalIndex]}`;
Â Â resultCard.classList.add('show', 'glow');

Â Â if (appealCount > 0) {
Â Â Â Â const btn = document.createElement('button');
Â Â Â Â btn.textContent = `ä¸Šè¨´ï¼ï¼ˆå‰©é¤˜${appealCount}æ¬¡ï¼‰`;
Â Â Â Â btn.className = 'btn-pink';
Â Â Â Â btn.style.marginTop = '20px';
Â Â Â Â btn.style.backgroundColor = ['#ffe6e6', '#ffb3b3', '#ff6666'][3 - appealCount] || '#ff6666';
Â Â Â Â btn.style.color = '#800000';
Â Â Â Â btn.onclick = () => {
Â Â Â Â Â Â appealCount--;
Â Â Â Â Â Â chooseRandom(true);
Â Â Â Â };
Â Â Â Â appealArea.appendChild(btn);
Â Â } else {
Â Â Â Â const finalText = document.createElement('div');
Â Â Â Â finalText.textContent = 'èªå‘½å§ï¼Œé€™å°±æ˜¯æœ€å¥½çš„é¸æ“‡ï¼';
Â Â Â Â finalText.style.marginTop = '20px';
Â Â Â Â finalText.style.fontWeight = 'bold';
Â Â Â Â finalText.style.color = '#b34400';
Â Â Â Â appealArea.appendChild(finalText);
Â Â }
Â Â enableRandomButton(); // ğŸ‘‰ æŠ½å®Œæ¢å¾©æŒ‰éˆ•
Â Â // âœ… é¡¯ç¤ºç‰¹æ•ˆé¸å–®å›ä¾†
document.getElementById('effectSelectorContainer').style.display = 'block';
}
Â Â const v = Date.now(); // æ¯æ¬¡åˆ·æ–°éƒ½å¸¶å…¥å”¯ä¸€å€¼ï¼Œé¿é–‹å¿«å–
document.querySelectorAll('link[rel="icon"], link[rel="manifest"]').forEach(el => {
Â Â if (el.href) {
Â Â Â Â el.href += (el.href.includes('?') ? '&' : '?') + 'v=' + v;
Â Â }
});
if ('serviceWorker' in navigator) {
Â Â navigator.serviceWorker.register('/service-worker.js?v=' + v)
Â Â Â Â .then(reg => console.log('SW è¨»å†ŠæˆåŠŸ', reg.scope))
Â Â Â Â .catch(err => console.log('SW è¨»å†Šå¤±æ•—', err));
}
const randomBtn = document.querySelector('.btn-primary');
randomBtn.classList.remove('disabled');
randomBtn.disabled = false;




function enableRandomButton() {
Â Â const randomBtn = document.querySelector('.btn-primary');
Â Â randomBtn.classList.remove('disabled');
Â Â randomBtn.disabled = false;
}

</script>
</body>
</html>

